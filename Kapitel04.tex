\newchapter{Ein hierarchischer Fehlerschätzer für Hindernisprobleme}
\label{kap:4}


Die adaptive Netzverfeinerung (s. Kapitel \ref{kap:2.4}) ist gerade auch bei Hindernis- und Kontaktproblemen von großem Vorteil. Wie wir in Kapitel \ref{kap:3} gesehen haben, führt die Lösung von solchen Problemen auf quadratische Programme, die wir mit zeitaufwändigen Verfahren lösen müssen. An dieser Stelle sei bemerkt, dass man Variationsungleichungen auch mit anderen Verfahren – häufig üblich ist z.B. die \textit{\idx{Penalty-Methode}} – lösen kann, die jedoch nicht weniger aufwendig sind.


Um nun eine adaptive Verfeinerungsstrategie herleiten zu können, müssen wir zunächst einen geeigneten Fehlerschätzer für unser Modellproblem \eqref{eq:3.1} erhalten. Dabei ist "`geeignet"' in dem Sinne zu verstehen, dass der Schätzer unseren echten Fehler nach oben und unten beschränkt. Weiter wollen wir mit dem Fehler a posteriori nach jedem Verfeinerungsschritt den Fehler in der nächsten Verfeinerung abschätzen. Mit diesen Fragestellungen werden wir uns in diesem Kapitel beschäftigen und einen ersten adaptiven Algorithmus sowie die Übertragung auf Kontaktprobleme zeigen.


Es sei bemerkt, dass man als a posteriori Fehlerschätzer für Hindernisprobleme in der Literatur häufig residuale Schätzer wiederfinden kann. Wir wollen uns jedoch hier mit einem hierarchischen Fehlerschätzer beschäftigen, dessen grundlegende Idee auch schon in Kapitel \ref{kap:2.4.1} dargestellt wurde.

Dieses Kapitel basiert größtenteils auf \cite{ZouVee}.




\section{Herleitung von einem hierarchischen a posteriori  Fehlerschätzer}
\label{kap:4.1}

Bevor wir uns detailliert der Herleitung eines hierarchischen a posteriori Fehlerschätzers widmen, wollen wir eine Generalvoraussetzung für das gesamte Kapitel \ref{kap:4} stellen.


\begin{vor}\label{vor:4.1}
Das Hindernis  wird durch eine stückweise lineare stetige Funktion $\psi$ beschrieben.
\end{vor}


Für nichtstetige oder auch glatte Hindernisse sind analoge Aussagen beweisbar, die jedoch schwerer zu zeigen sind. Für einen residualen Schätzer kann man das Vorgehen für glatte Hindernisse auch in \cite{Page} finden.







\subsection{Diskretisierung des Defektproblems}
\label{kap:4.1.1}


Es sei $\mcal B_h$ eine nodale Basis bzgl. einer quasi-uniformen Triangulierung $\mcal T_h$  für $\mcal S_h$ (s. Kapitel \ref{kap:2.3}), dem Raum der stückweise linearen Funktionen über $\mcal T_h$. Weiter sei $K_h$ wie in Kapitel \ref{kap:3.1.3} definiert
\[
	K_h  = \{v_h \in \mcal S_h \mid v_h (p) \ge \psi(p) \, \forall \, p \in \mcal N \cap \Omega\} \, , 
\]
wobei $\mcal N$ wieder die Menge der Knoten von $\mcal T_h$ darstellt. Wir betrachten nun wieder die diskrete Variationsungleichung \eqref{eq:3.12}: Finde $u_h \in K_h$ mit
\[
	a(u_h,v_h-u_h) \ge (f,v_h-u_h) \quad \forall \, v_h \in K_h
\]
oder äquivalent die Minimierung des Funktionals $J(v) = \frac 1 2 a(v,v)-(f,v)$ über $K_h$, d.h.
\begin{align}\label{eq:4.1}
	u_h \in K_h :\quad J(u_h)\le J(v_h) \quad \forall \, v_h \in K_h \, .
\end{align}
Wegen  Voraussetzung \ref{vor:4.1}, dass $\psi$ stückweise linear ist, gilt $K_h \subset K$, da die linearen Ansatzfunktionen nicht nur punktuell, sondern auch kontinuierlich die Nebenbedingung erfüllen. Damit ist \eqref{eq:3.12} eine konforme Finite-Elemente-Methode; nichtkonforme Finite-Elemente würden z.B. durch ein nichtstetiges Hindernis erzeugt werden. Diese sollen jedoch nicht Teil dieser Arbeit sein.


Wir werden einen a posteriori Fehlerschätzer für den Fehler bzgl. der Funktionswerte der Funktionale $J(u),J(u_h)$ herleiten. Hierfür gilt
\[
	J(u_h) - J(u) \ge 0\, ,
\]
denn aus den beiden Minimierungsproblemen über $K$ und $K_h$ folgt
\[
	J(u) \le J(v) \, \forall \, v \in K \, , \quad J(u_h) \le J(v_h) \, \forall \, v_h \in K_h \, .
\]
Da $K_h \subset K$ gilt, gilt insbesondere $J(u)\le J(v_h)$ für alle $v_h \in K_h$. Setzen wir $v_h = u_h$, so folgt
\[
	J(u) \le J(u_h) \Llra J(u_h)-J(u) \ge 0 \, .
\]


\begin{bem}\label{bem:4.2}
Gilt $\psi = -\infty$, d.h. ist kein Hindernis vorhanden, so folgt
\begin{align*}
	J(u_h)-J(u)  =& \frac 1 2 a(u_h,u_h)-(f,u_h) - \(\frac 1 2 a(u,u)-(f,u)\) \\
	 =& \frac 1 2 a(u_h,u_h)-(f,u_h) - \frac 1 2 a(u,u)+(f,u) \\
	 & +\overbrace{(a(u,u-u_h)-\underbrace{(f,u-u_h)}_{=(f,u)-(f,u_h)})}^{=0} \\
	 = & \frac 1 2a(u_h,u_h) - \frac 1 2 a(u,u) + a(u,u-u_h) \\
	 = & \frac 1 2 a(u_h,u_h) - \frac 1 2a(u,u)+a(u,u) - a(u,u_h) \\
	 = & \frac1 2 (a(u_h,u_h)+ a(u,u) - 2 a(u,u_h)) \\
	 = & \frac 1 2 a(u_h-u,u_h - u) = \frac 1 2 \norm{u_h-u}^2_E \, .
\end{align*}
Ist nun ein $\psi > -\infty$ gegeben, dann addieren wir im zweiten Schritt nicht mehr Null, sondern es gilt für den Term
\[
	a(u,u-u_h)-(f,u-u_h) \le 0
\]
und damit gilt $J(u_h)-J(u) \ge \frac 1 2\norm{u_h-u}_E^2$, d.h. eine obere Schranke des Fehlers im Funktional schätzt auch den Fehler zwischen exakter und approximierter Lösung in der Energienorm ab.
\end{bem}


\begin{notation}
Um im Folgenden den hierarchischen Split leichter beschreiben zu können, schreiben wir für die Galerkin-Lösung $u_h$ die Notation $u_{\mcal S}$, um auszudrücken, dass diese im linearen Ansatzraum $\mcal S_h$ liegt. Analog sind die im Weiteren übrigen verwendeten Indizes zu verstehen.

Zudem werden wir die für die Energienorm die Notation
\[
	a(v,v)^{\frac 12} = \norm{v}
\]
für alle $v \in H^1(\Omega)$, also ohne Index, verwenden. Auch in diesem Kapitel werden wir wieder $(u,v) = (u,v)_0$ für alle $u,v\in H^1(\Omega)$ schreiben.
\end{notation}


Zur Herleitung des hierarchischen Fehlerschätzers führen wir die Fehlerfunktion $e= u-u_{\mcal S}$ ein, die den exakten Fehler angibt. Weiter sei
\begin{align*}
	\mcal I(v) = \frac 12 a(v,v)-\rho_{\mcal S}(v)\text{ mit }\rho_{\mcal S} (v) = (f,v)-a(u_{\mcal S},v)\, ,\quad v \in H^1_0(\Omega) \, .
\end{align*}


\begin{bem}\label{bem:4.3}
\begin{enumerate}[(a)]
\item Die Linearform $\rho_{\mcal S}$ stellt das Residuum der Variationsgleichung (d.h. ohne Hindernis) dar.
\item Nach dem Darstellungssatz von Riesz existiert ein $v^* \in H^1_0(\Omega)$, so dass
\[
	(v^*,v) = \rho_{\mcal S} (v) \quad\forall \, v \in H^1_0(\Omega)
\]
ist. Wir können also $v^*$ als Lagrange-Multiplikator bzgl. der Nebenbedingung $v \ge \psi$ interpretieren.
\end{enumerate}
\end{bem}


Damit führen wir das \idx{Defektproblem} für das Hindernisproblem ein, welches der exakte Fehler $e$ löst.


\begin{satz}[Lösung des Defektproblems]\label{satz:4.4}
Mit den obigen Bezeichnungen löst die Fehlerfunktion $e$ folgendes Defektproblem:
\begin{align}\label{eq:4.2}
	e \in \mcal A:\quad  \mcal I(e) \le \mcal I(v) \quad \forall \, v \in \mcal A \, ,
\end{align}
wobei $\mcal A \coloneqq \{v \in H^1_0(\Omega) \mid v \ge \psi-u_{\mcal S}\} = -u_{\mcal S} + K$.
\end{satz}

\begin{proof}
Es sei $u$ die Lösung von \eqref{eq:3.2} und $u_{\mcal S}$ die Lösung von \eqref{eq:4.1}. Dann gilt
\begin{align*}\tag{$\ast$}
	 u \in K : \quad\qquad\quad \,\, \, \, \,  J(u)& \le J(\tilde v )\, \, \, \, \,  \qquad\qquad \forall \, \tilde v \in K \\
	\Llra u \in K : \quad J(u)-J(u_{\mcal S})& \le J(\tilde v) - J(u_{\mcal S}) \quad \forall \, \tilde v \in K \, .
\end{align*}
Wir rechnen für die linke Seite nach, dass gilt
\begin{align*}
	J(u)-J(u_{\mcal S}) & = \frac 1 2 a(u,u) - (f,u) -\(\frac 1 2 a(u_{\mcal S},u_{\mcal S}) - (f,u_{\mcal S})\) \\
	& = \frac 1 2 a(u,u)  + \frac 1 2 a(u_{\mcal S},u_{\mcal S}) - a(u_{\mcal S},u_{\mcal S}) - (f,u-u_{\mcal S}) \\
	& = \frac 1 2 a(u,u)  + \frac 1 2 a(u_{\mcal S},u_{\mcal S}) - a(u_{\mcal S},u) \\ 
	& \ \ \, - ((f,u-u_{\mcal S})- a(u_{\mcal S},u-u_{\mcal S})) \\
	& = \frac 1 2a(u-u_{\mcal S},u-u_{\mcal S})- \rho_{\mcal S} (u-u_{\mcal S}) \\
	& = \frac 1 2 a(e,e)-\rho_{\mcal S} (e) = \mcal I(e) \, .
\end{align*}
Analog gilt für die rechte Seite $J(\tilde v ) - J(u_{\mcal S}) = \mcal I(\tilde v - u_{\mcal S})$. Mit $v \coloneqq \tilde v - u_{\mcal S}$ gilt $v \in \mcal A$ und damit ist ($*$) äquivalent zu: Finde $e \in \mcal A$, so dass
\[
	\mcal I(e) \le \mcal I(v) \quad \forall \, v \in\mcal A \, . \qedhere
\]
\end{proof}


\begin{kor}\label{kor:4.5}
Das Problem \eqref{eq:4.2} ist äquivalent zur Variationsungleichung: Finde $e \in \mcal A$ mit
\begin{align}\label{eq:4.3}
	a(e,v-e) \ge \rho_{\mcal S} (v-e) \quad \forall \, v \in \mcal A \, .
\end{align}
\end{kor}

\begin{proof}
Analog zu Lemma \ref{lem:3.1} lässt sich zeigen, dass $\mcal A$ abgeschlossen und konvex ist. Aus Lemma \ref{lem:2.10} und \ref{lem:2.11} folgt, dass $\mcal I$ konvex und \idx{Gâteaux-differenzierbar} ist und mit Satz \ref{satz:A.10} folgt dann die Behauptung.
\end{proof}


\begin{bem*}
\begin{enumerate}[(a)]
\item Da $\psi$ stückweise linear ist und $\psi-u_{\mcal S} \le 0$ gilt, folgt $0 \in \mcal A$, d.h. das "`gewünschte"' Ergebnis für den Fehler $e$ liegt in der für das Defektproblem betrachteten Menge.
\item Wir werden noch zeigen, dass $\rho_{\mcal S}$ eine Schlüsselgröße für die a posteriori Abschätzung darstellt.
\end{enumerate}
\end{bem*}


Die Herleitung des a posteriori Schätzers vollzieht sich jetzt analog zu Kapitel \ref{kap:2.4.1} in zwei Schritten.
\begin{enumerate}[(i)]
\item	Diskretisiere \eqref{eq:4.3} bzgl. einer Erweiterung von $\mcal S_h$ (hier mit quadratischen Funktionen), so dass $e$ hinreichend genau approximiert wird.
\item Teile den neuen Raum so auf, dass \eqref{eq:4.3} lokal in der Erweiterung exakt gelöst werden kann.
\end{enumerate}


Als Erweiterung von $\mcal S_h$ betrachten wir einen Raum $\mcal Q_h$ mit $\mcal S_h \subset \mcal Q_h$, wobei
\[
	\mcal Q_h \coloneqq \{v \in C^0(\Omega) \mid v|_T \in \mcal P_2 \text{ für } T\in \mcal T_h, v|_{\partial\Omega} = 0\}
\]
ist, d.h. der Raum der stückweise quadratischen Funktionen über einer quasi-uniformen Zerlegung $\mcal T_h$. Damit definieren wir $\mcal N_{\mcal Q} \coloneqq \mcal N \cup \{x_E \mid E \in \mcal E\}$, wobei $x_E$ den Mittelpunkt der Kante $E$ bezeichne und $\mcal E$ somit die Menge aller Kanten ist. Daraus ergibt sich $\mcal A$ über $\mcal Q_h$ diskret als
\begin{align}\label{eq:4.4}
	\mcal A_{\mcal Q} \coloneqq \{v \in \mcal Q_h \mid v(p) \ge \psi(p)-u_{\mcal S}(p) \, \forall \, p \in \mcal N_{\mcal Q} \cap \Omega\} 
\end{align}
und im Bezug zu \eqref{eq:4.4} erhalten wir somit das diskrete Defektproblem
\begin{align}\label{eq:4.5}
	e_{\mcal Q} \in \mcal A_{\mcal Q} : \quad a(e_{\mcal Q}, v-e_{\mcal Q}) \ge \rho_{\mcal S}(v-e_{\mcal Q}) \quad \forall \, v \in \mcal A_{\mcal Q} \, .
\end{align}


\begin{bem}\label{bem:4.6}
Im Allgemeinen gilt hierbei nicht $\mcal A_{\mcal Q} \subset \mcal A$. So kann man sich anschaulich eine quadratische Funktion $v_{\mcal Q} \in \mcal A_{\mcal Q}$ vorstellen, die allerdings zwischen den übereinstimmenden Werten aufgrund ihrer Krümmung das lineare Hindernis aus $\mcal A$ durchdringt (vgl. das eindimensionale Beispiel aus Abbildung \ref{abb:4.1}).

\begin{figure}[h!]
\begin{center}
	\begin{pspicture}(0,0)(5,3)
		% Koordinatensystem:
		\psaxes[linewidth=0.65pt]{->}(0,0)(-0.3,-0.3)(6.7,2.7)
		\rput(6.7,-0.2){$x$}
		\rput(-0.2,2.7){$y$}
		
		% Das Hindernis:
		\psline[linewidth=0.6pt](1,0)(2,1)
		\psline[linewidth=0.6pt](2,1)(4,1.5)
		\psline[linewidth=0.6pt](4,1.5)(5,0)
		\rput(4.5,0.3){$\psi$}
		
		\psdots(2,1)(3,1.25)(4,1.5)
		
		% Die Funktion v:
		\psline[linestyle=dashed,linewidth=0.6pt](0,0)(2,1.5)
		\pscurve[linestyle=dashed,linewidth=0.6pt](2,1.5)(3,1.25)(4,1.5)
		\psline[linestyle=dashed,linewidth=0.6pt](4,1.5)(6,0)
		\rput(0.5,0.7){$v$}
	\end{pspicture}
\end{center}
\caption{Beispiel eines affinen Hindernisses $\psi$ mit $v \in \mcal A_{\mcal Q}$ in $\R$\label{abb:4.1}}
\end{figure}
\end{bem}


Als hierarchischen Split des Raumes $\mcal Q_h$ verwenden wir $\mcal Q_h = \mcal S_h + \mcal V_h$, wobei $\mcal V_h \coloneqq \{\phi_E \mid E \in \mcal E\}$ der Raum der quadratischen \textit{Bubble-Funktionen}\index{Bubble-Funktion} ist, wobei solch eine Bubble-Funktion $\phi_E$ bzgl. der Eck- und Kantenmittelpunkte eines Dreiecks definiert ist durch
\[
	\phi_E (p) = \delta_{x_E,p} = \begin{cases}
								1, & p = x_E \\
								0, & \text{sonst}
							\end{cases} .
\]
Es stellt sich nun die Frage, ob $\mcal Q_h$  als direkte Summe der beiden Räume $\mcal S_h$ und $\mcal V_h$ geschrieben werden kann.


\begin{satz}\label{satz:4.7}
Mit den oben verwendeten Notationen gilt $\mcal Q_h = \mcal S_h \oplus \mcal V_h$.
\end{satz}

\begin{proof}
Wir zeigen, dass $\mcal Q_h = \mcal S_h \oplus \mcal V_h$ auf dem Referenzdreieck gilt und damit gilt es auch für beliebige Dreiecke $T \in \mcal T_h$, da ein allgemeines Dreieck $T$ aus dem Referenzelement $\widetilde T$ (vgl. Kapitel \ref{kap:2.3}) durch affine Transformation hervorgeht.

Auf dem Referenzelement $\widetilde T$ ist $\{\phi_1,\phi_2,\phi_3\}$ eine Basis von $\mcal S_h$ mit
\[
	\phi_1(\xi,\eta) = 1-\xi-\eta \, , \quad \phi_2(\xi,\eta) = \xi \, , \quad \phi_3(\xi,\eta) = \eta
\]
und $\{\phi_4,\phi_5,\phi_6\}$ eine Basis von $\mcal V_h$ mit
\[
	\phi_1(\xi,\eta) = 4\xi (1-\xi-\eta) \, , \quad \phi_2(\xi,\eta) = 4\xi\eta \, , \quad \phi_3(\xi,\eta) = 4\eta(1-\xi-\eta) \, .
\]
Damit ist $\{\phi_1,\ldots,\phi_6\}$ ein Erzeugendensystem von $\mcal Q_h$, da jedes Element
\[
	a_0+a_1\xi+a_2\eta + a_3 \xi^2+ a_4\xi\eta +a_5\eta^2 \in \mcal Q_h
\]
als Linearkombination aus den Funktionen beschrieben werden kann ($\phi_1$ bis $\phi_6$ enthalten alle vorkommenden Summanden eines Polynom 2. Grades). Außerdem ist leicht nachzurechnen, dass die Funktionen $\phi_i,i = 1,\ldots,6,$ linear unabhängig sind und damit gilt
\[
	\mcal Q_h = \operatorname{span} \{\phi_1,\ldots,\phi_6\} \, .
\]
Aus der linearen Unabhängigkeit folgt damit auch $\mcal S_h \cap \mcal V_h = \{0\}$ gilt und damit die Behauptung.
\end{proof}

Satz \ref{satz:4.7} erlaubt es uns also, jedes Element $v_{\mcal Q} \in \mcal Q_h$  als $v_{\mcal Q} = v_{\mcal S} + v_{\mcal V}$ mit $v_{\mcal S} \in \mcal S_h, v_{\mcal V}\in \mcal V_h$ schreiben zu können. Aus diesem Grund führen wir folgende Bilinearform ein:
\begin{align*}
	a_{\mcal Q} (v,w) \coloneqq a(v_{\mcal S},w_{\mcal S}) + \sum_{E \in \mcal E} u_{\mcal V}(x_E) w_{\mcal V}(x_E) a(\phi_E,\phi_E) \quad \forall \, v,w \in \mcal Q_h \, ,
\end{align*}
welche aufgrund der Eigenschaften der direkten Summe von $\mcal S_h$ und $\mcal V_h$ wohldefiniert ist. Dabei erhält man $a_{\mcal Q}$ durch Entkopplung von $a$ bzgl. der Räume $\mcal S_h$ und $\mcal V_h$ und anschließender "`Diagonalisierung"' auf $\mcal V_h$ in dem Sinne, dass wir nur noch die Koordinaten der Elemente $v,w$ auf $\mcal V_h$ betrachten, deren Basisfunktionen $\phi_E$ gleich sind. Wenn wir mittels $a_{\mcal Q}$ eine Matrix bzgl. der Basisfunktionen $\phi_E$ mit dem bekannten Muster aus dem Galerkinverfahren aufstellen, ergibt sich eine Diagonalmatrix.

Es ist legitim und sinnvoll mit der im Vergleich zur Bilinearform $a$ einfacheren Form $a_{\mcal Q}$ weiterzuarbeiten, was  der folgende Satz besagt.


\begin{satz}\label{satz:4.8}
Die zu $a_{\mcal Q}$ assoziierte Energienorm
\begin{align*}
	\norm v_{\mcal Q}\coloneqq a_{\mcal Q}(v,v)^{\frac 1 2} \, , \quad v \in \mcal Q_h
\end{align*}
ist äquivalent zur Energienorm $a(\cdot,\cdot)^{\frac 12} = \norm\cdot$, d.h. es gibt Konstanten $c_1,c_2$ $($die insbesondere nur von der Quasi-Uniformität von $\mcal T_h$ abhängen$)$, so dass
\[
	c_1 \, \norm v \le \norm v_{\mcal Q} \le c_2 \, \norm v \, , \quad \forall \, v \in \mcal Q_h \, .
\]
\end{satz}

\begin{proof}
Die Aussage folgt aus Theorem 4.1 bzw. Bemerkung 4.3 in \cite{HoppeKorn} zusammen mit dem Lemma auf Seite 14 in \cite{Deufl}.
\end{proof}


Deshalb führen wir die approximierte Energie
\begin{align}\label{eq:4.6}
	\mcal I_{\mcal Q} (v) \coloneqq \frac 1 2 a_{\mcal Q}(v,v)-\rho_{\mcal S}(v) \, , \quad v \in \mcal Q_h 
\end{align}
ein, das damit verbundene Defektproblem ist allerdings noch durch die Nebenbedingung aus $\mcal A_{\mcal Q}$ mit $\mcal S_h$ gekoppelt und daher noch nicht alleine auf die Raumerweiterung $\mcal V_h$ bezogen. Als Abhilfe ignorieren wir einfach die linearen Beiträge in $\mcal A_{\mcal Q}$ und führen eine echte Teilmenge 
\begin{align}\label{eq:4.7}
	\mcal A_{\mcal V} \coloneqq \{v \in \mcal V_h \mid v(x_E) \ge \psi(x_E)-u_{\mcal S}(x_E) \, \forall \, E \in \mcal E\}
\end{align}
von $\mcal A_{\mcal Q}$ ein. Zusammen mit \eqref{eq:4.6} und \eqref{eq:4.7} erhalten wir dann das lokale diskrete Defektproblem\index{Defektproblem!lokales}
\begin{align}\label{eq:4.8}
	\eps_{\mcal V} \in \mcal A_{\mcal V} : \quad \mcal I_{\mcal Q}(\eps_{\mcal V}) \le \mcal I_{\mcal Q} (v) \quad \forall \, v \in \mcal A_{\mcal V}
\end{align}
bzw. die dazu äquivalente Variationsungleichung
\begin{align}\label{eq:4.9}
	\eps_{\mcal V} \in \mcal A_{\mcal V} : \quad a_{\mcal Q} (\eps_{\mcal V},v-\eps_{\mcal V})\ge \rho_{\mcal S} (v-\eps_{\mcal V}) \quad \forall \, v \in \mcal A_{\mcal V} \, .
\end{align}


\begin{bem}\label{bem:4.9}
\begin{enumerate}[(a)]
\item Da $\psi$ stetig stückweise linear ist und somit $u_{\mcal S} \ge \psi$ gilt, folgt $0 \in \mcal A_{\mcal V}$. Damit ist auch hier die gewünschte Lösung für $\eps_{\mcal V}$ in $\mcal A_{\mcal V}$ enthalten
\item	Auch für $\mcal A_{\mcal V}$ lässt sich mit analogem Vorgehen zu Lemma \ref{lem:3.1} die Konvexität zeigen.
\end{enumerate}
\end{bem}


\begin{lemma}\label{lem:4.10}
Das Energiefunktional $\mcal I_{\mcal Q}$ ist konvex.
\end{lemma}

\begin{proof}
Da $a$ eine stetige koerzive Bilinearform, werden aufgrund der Konstruktion von $a_{\mcal Q}$ diese Eigenschaften auch auf $a_{\mcal Q}$ übertragen. Weiterhin ist leicht zu überprüfen, dass $\rho_{\mcal S}$ eine stetige Linearform ist. Dann folgt aus Lemma \ref{lem:2.10} direkt die Behauptung.
\end{proof}


Das lokale diskrete Defektproblem \eqref{eq:4.9} ist sogar exakt lösbar. Die Lösung des Problems gibt uns der nächste Satz.


\begin{satz}\label{satz:4.11}
Die Lösung von \eqref{eq:4.8} bzw. \eqref{eq:4.9} ist explizit gegeben durch
\begin{align}\label{eq:4.10}
	\eps_{\mcal V} (x_E) = \frac{\max \{-d_E,\rho_E\}}{\norm{\phi_E}} \, 
\end{align}
wobei
\begin{align}\label{eq:4.11}
	d_E = (u_{\mcal S}(x_E) - \psi (x_E))\norm{\phi_E} \ge 0 \, , \quad \rho_E = \frac{\rho_{\mcal S}(\phi_E)}{\norm{\phi_E}} \, .
\end{align}
\end{satz}

\begin{proof}
Es sei $M = \abs{\mcal E}$ die Anzahl der Kanten. Zunächst berechnen wir zur besseren Übersicht $\eps_{\mcal V}(x_E)$ konkret, d.h.
\begin{align}\notag
	\eps_{\mcal V} (x_E) & =  \frac{\max \{-d_E,\rho_E\}}{\norm{\phi_E}} \\
	\notag
	& = \frac{\max \left\{(\psi (x_E)-u_{\mcal S}(x_E) )\norm{\phi_E} ,\frac{\rho_{\mcal S}(\phi_E)}{\norm{\phi_E}}\right\}}{\norm{\phi_E}} \\
	\notag
	& = \max \left\{\psi (x_E)-u_{\mcal S}(x_E)  ,\frac{\rho_{\mcal S}(\phi_E)}{\norm{\phi_E}^2}\right\} \\
	\label{eq:4.12}
	& = \max \left\{\psi (x_E)-u_{\mcal S}(x_E)  ,\frac 1{\norm{\phi_E}^2} ((f,\phi_E)-a(u_{\mcal S},\phi_E))	\right\} \, .
\end{align}
Da  $\eps_{\mcal V} = \sum_{E \in \mcal E} \eps_{\mcal V}(x_E) \phi_E$ ist, können wir \eqref{eq:4.8} bzgl. der Basis $\{\phi_E \mid E \in \mcal E\}$ von $\mcal V_h$ diskret schreiben als
\begin{align*}
	\min_{\bs v \in \R^M} \frac 1 2 \bs v^T D \bs v - \bs g^T \bs v \quad \text{s.t.} \quad\bs v \ge \bs \psi - \bs u_{\mcal S}\, , 
\end{align*}
wobei $\bs v = [\eps_{\mcal V}(x_{E_i})]_{1\le i \le M}, D = \operatorname{diag}(a(\phi_{E_1},\phi_{E_1}),\ldots,a(\phi_{E_M},\phi_{E_M})), \bs g = [(f,\phi_{E_i})-a(u_{\mcal S},\phi_{E_i})]_{1\le i\le M}, \bs \psi = [\psi(x_{E_i})]_{1\le i \le M}$ und $ \bs u_{\mcal S} = [u_{\mcal S}(x_{E_i})]_{1\le i \le M}$. Da $\mcal A_{\mcal V}$ und $\mcal I_{\mcal Q}$ konvex sind, existiert ein Minimum $\bs v^* \in \mcal A_{\mcal V}$ von $\mcal I_{\mcal Q}$, das die KKT-Bedingungen erfüllt. Damit gilt
\begin{subequations}\label{eq:4.13}
\begin{align}\label{eq:4.13a}
	D \bs v-\bs g - \bs \lambda & = \bs 0 \, , \\
	\label{eq:4.13b}
	\bs \lambda &\ge 0\, ,\\
	\label{eq:4.13c}
	\bs v & \ge \bs \psi - \bs u_{\mcal S}\,  , \\
	\label{eq:4.13d}
	\lambda_i\, (\bs v - \bs \psi+\bs u_{\mcal S})_i &= 0 \quad \forall \, i=1,\ldots,M \, .
\end{align}
\end{subequations}
Es sei $k \in \{1,\ldots,M\}$ beliebig.

\underline{Fall 1:} Gilt $\lambda_k = 0$, so folgt aus \eqref{eq:4.13a}
\[
	\eps_{\mcal V} (x_{E_k}) = v_k = \frac {g_k}{a(\phi_{E_k},\phi_{E_k})} = \frac 1{\norm{\phi_{E_k}}^2} ((f,\phi_{E_k})-a(u_{\mcal S},\phi_{E_k})) \, .
\]

\underline{Fall 2:} Gilt $\lambda_k \not= 0$, dann folgt wegen \eqref{eq:4.13d}
\[
	\eps_{\mcal V} (x_{E_k}) =v_k = (\bs \psi - \bs u_{\mcal S})_k = \psi(x_{E_k}) - u_{\mcal S}(x_{E_k})\, .
\]
Insgesamt folgt mit \eqref{eq:4.13c} und \eqref{eq:4.12} die Behauptung.
\end{proof}


Als a posteriori Fehlerschätzer werden wir im Folgenden 
\[
	-\mcal I_{\mcal Q} (\eps_{\mcal V})= -\frac 1 2 a_{\mcal Q}(\eps_{\mcal V},\eps_{\mcal V}) + \rho_{\mcal S}(\eps_{\mcal V})
\]
betrachten und zeigen, dass dieser äquivalent zum Fehler im Funktional $J(u_{\mcal S}) - J(u)$ ist (vgl. Kapitel \ref{kap:4.1.4} und \ref{kap:4.1.5}). Zunächst wollen wir aber eine Einführung der lokalen Anteile des Fehlerschätzers $-\mcal I_{\mcal Q} (\eps_{\mcal V})$ bieten.






\subsection{Lokaler Anteil des Fehlerschätzers}
\label{kap:4.1.2}


\begin{notation}
\begin{enumerate}[(a)]
\item Wir schreiben im Folgenden "`$\lesssim$"' statt "`$\le C$"', wenn die Konstante $C$ nur von der Quasi-Uniformität von $\mcal T_h$ abhängt.
\item Weiter schreiben wir "`$A \approx B$"' für "`$A\lesssim B$"' und "`$B \lesssim A$"'.
\end{enumerate}
\end{notation}


Um die lokalen Anteile des Fehlerschätzers herzuleiten, zeigen wir zunächst ein paar Eigenschaften der Fehlerfunktion $e = u-u_{\mcal S}$.



\begin{lemma}\label{lem:4.12}
Die Fehlerfunktion $e = u-u_{\mcal S}$ erfüllt die Ungleichungen
\begin{align}\label{eq:4.14}
	\frac 12 \norm e^2 \le \frac 12 \rho_{\mcal S}(e) \le -\mcal I (e) \le \rho_{\mcal S}(e) \, .
\end{align}
\end{lemma}

\begin{proof}
Wir erinnern uns, dass
\[
	-\mcal I (e) \coloneqq - \frac 12 \underbrace{a(e,e)}_{\ge 0} + \rho_{\mcal S} (e) \le \rho_{\mcal S}(e) \, , 
\]
da $a$ koerziv ist. Dann gilt weiter
\begin{align*}
	-\mcal I(e) & = - \frac 12 a(e,e) + \rho_{\mcal S} (e) \\
	& = -\frac 1 2 a(u-u_{\mcal S},e) + \rho_{\mcal S} (e) \\
	& = -\frac 1 2 a(u,e) \underbrace{\frac 1 2 a(u_{\mcal S},e)-\frac 1 2(f,e)}_{=-\frac 12 \rho_{\mcal S}(e)} + \frac 1 2 (f,e)+\rho_{\mcal S}(e) \\
	& = -\frac 12 (\underbrace{a(u,u-u_{\mcal S})-(f,u-u_{\mcal S})}_{\le 0}) + \frac 1 2\rho_{\mcal S}(e) \ge \frac 1 2\rho_{\mcal S}(e) \, .
\end{align*}

Es bleibt also die erste Ungleichung von \eqref{eq:4.14} zu zeigen. Wir rechnen nach, dass
\begin{align*}
	\frac 1 2 \rho_{\mcal S} (e) &= \frac 1 2 (f,e)-\frac 1 2a(u_{\mcal S},e) \\
	& = \frac 1 2 (\underbrace{(f,u-u_{\mcal S}) - a(u,u-u_{\mcal S})}_{\ge 0} + a(u-u_{\mcal S},e)) \\
	& \ge \frac 1 2 a(u-u_{\mcal S},e) =\frac 1 2 a(e,e) =  \frac 1 2 \norm e^2 
\end{align*}
gilt, womit \eqref{eq:4.14} insgesamt bewiesen ist.
\end{proof}


\begin{kor}\label{kor:4.13}
Für die Lösungen $e_{\mcal Q}, \eps_{\mcal V}$ von \eqref{eq:4.5} und \eqref{eq:4.9} gilt
\begin{align}\label{eq:4.15}
	\frac 12 \norm{e_{\mcal Q}}^2 \le \frac 12 \rho_{\mcal S}(e_{\mcal Q})& \le -\mcal I (e_{\mcal Q}) \le \rho_{\mcal S}(e_{\mcal Q}) \, ,\\
	\label{eq:4.16}
	\frac 12 \norm {\eps_{\mcal V}}_{\mcal Q}^2 \le \frac 12 \rho_{\mcal S}(\eps_{\mcal V})& \le -\mcal I_{\mcal Q} (\eps_{\mcal V}) \le \rho_{\mcal S}(\eps_{\mcal V})\, .
\end{align}
\end{kor}

\begin{proof}
Da $e_{\mcal Q}$ und $\eps_{\mcal V}$ Lösungen der Variationsungleichungen \eqref{eq:4.5} und \eqref{eq:4.9} sind, folgt die Behauptung analog zum Beweis von Lemma \ref{lem:4.12}.
\end{proof}


Wegen \eqref{eq:4.16} ist also $\rho_{\mcal S} (\eps_{\mcal V})$ äquivalent zum Fehlerschätzer $-\mcal I_{\mcal Q}(\eps_{\mcal V})$ und kann daher als \idx{Fehlerindikator} für $-\mcal I_{\mcal Q} (\eps_{\mcal V})$ verwendet werden, denn wenn wir  $\rho_{\mcal S}$ verkleinern, so wird auch $-\mcal I_{\mcal Q}$ kleiner. In Kapitel \ref{kap:4.1.4} und \ref{kap:4.1.5} werden wir dann die Äquivalenz von $-\mcal I_{\mcal Q}(\eps_{\mcal V})$ zum exakten Fehler in den Funktionalen $J(u_{\mcal S}) - J(u)=-\mcal I(e)$ zeigen.


Aus Lemma \ref{lem:4.12} folgt analog, dass der Fehler $J(u_{\mcal S})-J(u)$ äquivalent zu $\rho_{\mcal S}(e)$ ist. Daher werden wir die lokalen Anteile des Fehlerschätzers mittels $\rho_{\mcal S}(\eps_{\mcal V})$ berechnen. Es sei $u_{\mcal S}$ die Lösung von \eqref{eq:3.12}, dann gilt für alle $T\in \mcal T_h$ die Gleichung $\Delta u_{\mcal S} = 0$, da $u_{\mcal S}$ auf jedem $T$ linear ist. Mit $\Omega = \bigcup_{T \in \mcal T_h} T$ berechnen wir daher für alle $v \in H^1(\Omega)$
\begin{align}\notag 
	\rho_{\mcal S} (v) & = (f,v)-a(u_{\mcal S},v) = \int_{\Omega} fv \, dx - \int_{\Omega} \nabla u_{\mcal S} \nabla v \, dx \\
	\notag
	& = \int_{\Omega} fv \, dx - \sum_{T\in \mcal T_h} \int_T \nabla u_{\mcal S}\nabla v \, dx \\
	\notag
	& = \int_{\Omega} fv \, dx - \sum_{T\in \mcal T_h} \(\int_{\partial T} v \partial_{\bs n} u_{\mcal S} \, ds -  \int_T \underbrace{\Delta u_S}_{=0} v \, dx \) \\
	\label{eq:4.17}
	& = \int_{\Omega} fv \, dx - \sum_{T\in \mcal T_h} \int_{\partial T} v \partial_{\bs n} u_{\mcal S} \, ds \, ,
\end{align}
wobei im vorletzten Schritt die 1. Green'sche Formel angewendet wurde und $\bs n$ die äußere Einheitsnormale von einem Dreieck $T$ bezeichnet.


Betrachten wir zwei beliebige Dreiecke $T_1,T_2$ wie in Abbildung \ref{abb:4.2}, wobei $\bs n$ hierbei die Einheitsnormale, die von $T_1$ nach $T_2$ zeigt, bezeichnet, so können wir die Summe aus \eqref{eq:4.17} bzgl. der Menge der Kanten $\mcal E$ darstellen, da der Rand $\partial T = E_1 \cup E_2 \cup E_3$ für jedes $T$ disjunkt in seine Kantenstücke aufgeteilt werden kann.

Dabei sei $E$ nun die Kante, die $T_1$ und $T_2$ zugleich enthalten, d.h. $\bs n$ steht rechtwinklig auf $E$. Dann gilt, dass die Richtungsableitung $\partial_{\bs n} u_{\mcal S}|_{T_2}$ negativ ist bzgl. \eqref{eq:4.17} wegen der negativen Orientierung von $\bs n$ bzgl. $T_2$.

\begin{figure}[h]
  \begin{center}
    \begin{pspicture}(-1.5,0)(2,2.2)
    	% Die zwei Dreiecke:
	\psline(-1.5,1.7)(1,2)
	\psline(1,2)(-0.2,-0.2)
	\psline(-0.2,-0.2)(-1.5,1.7)
	\psline(1,2)(2.5,0.4)
	\psline(2.5,0.4)(-0.2,-0.2)
	\rput(-0.7,1.4){$T_1$}
	\rput(1.9,0.55){$T_2$}
	
	% Normalenvektor:
	\psline{->}(0.35,0.8)(1,0.45)
	\rput(0.8,0.9){$\bs n$}
	\psellipticarc[linewidth=0.5pt](0.35,0.8)(0.25,0.25){242}{335}
	\psdot[dotsize=1.3pt](0.38,0.68)
	
	% Beschriftung der Kante E:
	\rput(0.55,1.65){$E$}
    \end{pspicture}
  \end{center}
\caption{Dreiecke $T_1$ und $T_2$ mit Einheitsnormalen $\bs n$\label{abb:4.2}}
\end{figure}

Dies in \eqref{eq:4.17} eingesetzt ergibt
\begin{align}\notag
	\rho_{\mcal S} (v) &= \int_{\Omega} fv \, dx - \sum_{T\in \mcal T_h} \int_{\partial T} v \partial_{\bs n} u_{\mcal S} \, ds \\
	\notag
	& = \int_{\Omega} fv \, dx - \sum_{E\in \mcal E} \int_{E} v\, (\underbrace{\partial_{\bs n} u_{\mcal S}|_{T_1}-\partial_{\bs n} u_{\mcal S}|_{T_2}}_{\eqqcolon -j_E}) \, ds \\
	\label{eq:4.18}
	& =  \int_{\Omega} fv \, dx + \sum_{E\in \mcal E} \int_{E} j_E v \, ds \, .
\end{align}
Da für die nodalen Basisfunktionen $\{\phi_p \mid p \in \mcal N\cap \Omega\}$ von $\mcal S_h$ die Partition der Eins gilt, also
\[
	\sum_{p \in \mcal N} \phi_p = 1 \text{ auf ganz } \Omega \, ,
\]
lässt sich $\rho_{\mcal S}$ wie folgt in lokale Anteile aufteilen können:
\begin{align}\label{eq:4.19}
	\rho_p(v) \coloneqq \rho_{\mcal S} (v \phi_p) \, , \quad v \in H^1(\Omega) , p \in \mcal N \, .
\end{align}

In Lemma \ref{lem:4.14} werden wir zeigen, dass wir den in \eqref{eq:4.19} definierten lokalen Anteil von $\rho_{\mcal S}$ leicht berechnen können, und mit der Aussage aus Korollar \ref{kor:4.15}, dass sich der \idx{Fehlerindikator} $\rho_{\mcal S}$ auch eindeutig in die lokalen Anteile $\rho_p$ zerlegen lässt.


\begin{lemma}\label{lem:4.14}
Für $\rho_p$ gilt
\begin{align*}
	\rho_p (v) = \int_{\omega_p} f v \phi_p \, dx + \sum_{E\in \mcal E_p} \int_E j_E v \phi_p \, ds  \, , \quad v \in H^1(\Omega)
\end{align*}
mit $\omega_p \coloneqq \supp \phi_p$ und $\mcal E_p \coloneqq \{E \in \mcal E \mid E \ni p\}$, d.h. die Menge der Kanten, in denen $p$ enthalten ist.
\end{lemma}

\begin{proof}
Wir rechnen einfach mit der Definition \eqref{eq:4.19} und \eqref{eq:4.18} nach, dass für ein beliebiges $v \in H^1(\Omega)$ gilt
\begin{align*}
	\rho_p(v) &= \rho_{\mcal S} (v \phi_p) =  \int_{\Omega} fv\phi_p \, dx + \sum_{E\in \mcal E} \int_{E} j_E v \phi_p\, ds \\
	& = \int_{\omega_p} f v \phi_p \, dx + \sum_{E\in \mcal E_p} \int_E j_E v \phi_p \, ds  \, ,
\end{align*}
da $\phi_p \equiv 0$ auf $\mcal O \coloneqq \overline{\Omega \setminus \omega_p}$ und damit auch auf $\mcal F \coloneqq\mcal E \setminus \mcal E_p$, da $\mcal F \subset\mcal O$ (vgl. Abbildung \ref{abb:4.3}). \qedhere

\begin{figure}[h!]
\begin{center}
	\begin{pspicture}(0,0)(7,5.3)
		%\psset{xunit=1.5cm,yunit=1.2cm}
		
		% \omega_p:
		\pspolygon[fillstyle=solid,fillcolor=lightgray](2.5,1.25)(3,2.6)(1.5,2.5)
		\pspolygon[fillstyle=solid,fillcolor=lightgray](2.5,1.25)(3,2.6)(4.7,2)
		\pspolygon[fillstyle=solid,fillcolor=lightgray](4.3,3.5)(3,2.6)(4.7,2)
		\pspolygon[fillstyle=solid,fillcolor=lightgray](4.3,3.5)(3,2.6)(2.5,3.5)
		\pspolygon[fillstyle=solid,fillcolor=lightgray](1.5,2.5)(3,2.6)(2.5,3.5)
		
		% Rest:
		\pspolygon(1.5,2.5)(0.75,3)(2.5,3.5)
		\pspolygon(1.5,2.5)(0.75,3)(1.2,1.5)
		\pspolygon(1.5,2.5)(2.5,1.25)(1.2,1.5)
		\pspolygon(1.2,1.5)(2.5,1.25)(1.9,0.5)
		\pspolygon(4.7,2)(2.5,1.25)(4.3,0.9)
		\pspolygon(4,-0.1)(2.5,1.25)(4.3,0.9)
		\pspolygon(4.7,2)(6.5,1.5)(4.3,0.9)
		\pspolygon(4.7,2)(6.5,1.5)(6.5,2.75)
		\pspolygon(4.7,2)(4.3,3.5)(6.5,2.75)
		
		\psline(1.2,1.5)(0.3,0.6)
		\psline(0.75,3)(0.25,3.25)
		\psline(2.5,3.5)(2.2,3.8)
		\psline(2.5,3.5)(2.9,3.9)
		\psline(4.3,3.5)(5.1,3.8)
		\psline(6.5,2.75)(6.3,3.3)
		\psline(6.5,1.5)(7.1,0.8)
		\psline(6.5,1.5)(7,1.8)
		\psline(6.5,2.75)(7,2.3)
		\psline(4.3,0.9)(5.9,0.3)
		
		% Hutfunktion:
		\psline[linestyle=dotted](3,2.6)(3,4.8)
		\psline[linewidth=0.6pt](3,4.8)(2.5,1.25)
		\psline[linewidth=0.6pt](3,4.8)(4.3,3.5)
		\psline[linewidth=0.6pt](3,4.8)(1.5,2.5)
		\psline[linewidth=0.6pt](3,4.8)(4.7,2)
		\psline[linewidth=0.6pt](3,4.8)(2.5,3.5)
		
		% Beschriftungen:
		\rput(3.2,5){$\phi_p$}
		\rput(3.1,2.3){$p$}
		\rput(2.2,2.1){$\omega_{p}$}
		
	\end{pspicture}
\end{center}
\caption{Darstellung von $\omega_p$ (grau) und $\mcal E_p$ (abgehende Kanten von $p$) \\ für ein beliebiges $\phi_p$\label{abb:4.3}}
\end{figure}
\end{proof}

 
\begin{kor}\label{kor:4.15}
Der Indikator $\rho_{\mcal S}$ lässt sich schreiben als
\begin{align}\label{eq:4.20}
	\rho_{\mcal S} = \sum_{p \in \mcal N} \rho_p \, .
\end{align}
\end{kor}

\begin{proof}
Die Behauptung folgt direkt aus Lemma \ref{lem:4.14} zusammen mit
\[
	\Omega = \bigcup_{p\in \mcal N} \omega_p \, , \quad \mcal E = \bigcup_{p \in \mcal N} \mcal E_p \quad \text{und}\quad \sum_{p \in \mcal N} \phi_p = 1 \, 
\]
durch einfaches Nachrechnen.
\end{proof}


Im unbeschränkten Fall gilt $\rho_{\mcal S} = 0 \Lra e = 0$, denn zu $\rho_{\mcal S} = 0$ ist 
\[
	a(e,v) = \rho_{\mcal S}(v) = 0 \quad \forall \, v \in \mcal V
\]
äquivalent. Da $e\in \mcal V$ ist, folgt wegen der \idx{Galerkin-Orthogonalität}, dass $e=0$ sein muss. Die Umkehrung gilt offensichtlich auch.

Wie wir schon weiter oben beschrieben haben, gilt die Galerkin-Orthogo-nalität\index{Galerkin-Orthogonalität} bei Variationsungleichungen gilt  im Allgemeinen nicht. Aber aus Lemma \ref{lem:4.12} folgt allgemeiner, falls $\rho_{\mcal S} (v) \le 0$ für alle $v \in \mcal A$ gilt,
\[
	\frac 12 \norm{e}^2 \le \rho_{\mcal S}(e) \le 0\,  \lra\,  \norm e = 0 \, \lra\, e = 0 \, ,
\]
d.h. aus $\rho_{\mcal S} = 0$ folgt, dass $e = 0$ ist. Man kann nun diese globale Eigenschaft auch auf die lokalen Anteile übertragen. Mit $u_{\mcal S}$ als Lösung von \eqref{eq:3.12} gilt für alle $p \in \mcal N \cap \Omega$, dass $v = u_{\mcal S} + \phi_p  \ge \psi$, d.h. $v \in K_h$. Daraus folgt mit Einsetzen von $v$ in  \eqref{eq:3.12}
\begin{align}\notag
	&a(u_{\mcal S}, u_{\mcal S} + \phi_p - u_{\mcal S}) \ge (f,u_{\mcal S}+\phi_p-u_{\mcal S}) \\
	\label{eq:my4.20}
	\Llra \,  & 0 \ge (f,\phi_p)-a(u_{\mcal S},\phi_p) = \rho_{\mcal S}(\phi_p) \, .
\end{align}
Dies bedeutet, dass die lineare Approximation des Fehlers $e$ gleich Null ist. Falls an einem Punkt $p$ kein Kontakt zwischen $u_{\mcal S}$ und $\psi$ vorliegt, also $u_{\mcal S} (p) > \psi(p)$ ist, dann können wir ein $\alpha > 0$ hinreichend klein wählen, sodass $v = u_{\mcal S} - \alpha \phi_p \in K_h$ liegt. Dann folgt analog durch Einsetzen von $v$ in \eqref{eq:3.12}
\begin{align*}
	0 & \ge (f,-\alpha \phi_p) - a(u_{\mcal S},-\alpha\phi_p) \\
	\Llra \, 0 & \le (f,\phi_p) - a(u_{\mcal S},\phi_p) = \rho_{\mcal S} (\phi_p) \stackrel[\scriptsize\eqref{eq:my4.20}]{}\le 0
\end{align*}
und damit gilt $\rho_{\mcal S} (\phi_p) = 0$.  Zusammen ergeben sich die (KKT-)Bedingungen
\begin{align}\label{eq:4.21}
	\rho_{\mcal S} (\phi_p) \le 0 \, , \quad \psi(p)-u_{\mcal S} (p) \le 0 \, , \quad \rho_{\mcal S} (\phi_p) (\psi(p)-u_{\mcal S} (p)) = 0 \, .
\end{align}
Dies berechtigt zur Definition von Kontakt- und Nichtkontaktpunkten.


\begin{defi}\label{def:4.16}
Wir definieren die Mengen von  \textit{inneren Kontaktknoten}\index{Kontaktknoten} $\mcal N^0$ und \textit{Nichtkontaktknoten}\index{Nichtkontaktknoten} $\mcal N^+$ durch
\begin{align*}
	\mcal N^0 \coloneqq  \{p \in \mcal N \cap \Omega \mid u_{\mcal S}(p) = \psi (p) \} \, , \quad 
	\mcal N^+ \coloneqq  \{p \in \mcal N \cap \Omega \mid u_{\mcal S}(p) > \psi (p) \}\, .
\end{align*}
\end{defi}


\begin{bem}\label{bem:4.17}
Die Bedingungen \eqref{eq:4.21} können wir auch auf den lokalen Anteil $\rho_p$ übertragen, damit ergibt sich für alle $p \in \mcal N \cap \Omega$
\begin{subequations}\label{eq:4.22}
\begin{align}\label{eq:4.22a}
	\rho_p(1) &  \le 0\, ,  \\
	\label{eq:4.22b}
	u_{\mcal S} (p) > \psi (p) \, & \lra \, \rho_p(1) =0 \, ,
\end{align}
\end{subequations}
denn $\rho_p (1) = \rho_{\mcal S} (\phi_p)$.
\end{bem}


Damit ist also die Approximation von $e$ über $\mcal S_h$ gleich Null, wenn die lokalen Anteile von $\rho_{\mcal S}$ kleiner gleich Null sind. 





\subsection{Oszillationsterme}
\label{kap:4.1.3}

In Kapitel \ref{kap:4.1.4} werden wir zeigen, dass $-\mcal I_{\mcal Q} (\eps_{\mcal V})$ eine obere Schranke von $-\mcal I (e)$ bis auf Terme höherer Ordnung bereitstellen, d.h. Terme, die nicht in $\mcal V$ enthalten sind. Diese sogenannten \textit{\idx{Oszillationsterme}} wollen wir daher in diesem Kapitel anschaulich einführen (ohne präzise Beweise). 

Wie wir später auch in den numerischen Beispielen sehen werden, bringt eine Verkleinerung der Oszillation auch eine Verringerung des Fehlers mit sich. Daher ist es von Interesse die Oszillationsterme einfach berechnen zu können und auch mit in die adaptive Verfeinerung einzubeziehen.

Wir werden zwei Arten von Oszillationen betrachten und daher die Gesamtoszillation in diese Anteile aufteilen.
\begin{align}\label{eq:4.24}
	\osc (u_{\mcal S}, \psi, f) \coloneqq \(\osc_1(u_{\mcal S},\psi)^2+\osc_2(u_{\mcal S},\psi,f)^2\)^{\frac 12}
\end{align}


\begin{bem}\label{bem:4.18}
In \cite{ZouVee} werden die \idx{Oszillationsterme} \eqref{eq:4.24} durch
\[
	\osc (u_{\mcal S}, \psi, f) = \osc_1(u_{\mcal S},\psi)+\osc_2(u_{\mcal S},\psi,f)
\]
eingeführt. Wir wählen hier absichtlich eine leicht veränderte Darstellung, da diese für die spätere Implementierung bzgl. der lokalen Anteile der Oszillationen von Vorteil ist. Außerdem ist in vielen Fällen die Menge  $\mcal N^{0+}$ (s.u.) nach wenigen Verfeinerungsschritten leer, sodass $\osc (u_{\mcal S},\psi,f) = \osc_2(u_{\mcal S},\psi,f)$ in beiden beschriebenen Fällen gilt.

Im unbeschränkten Fall ist die Oszillation nur von $f$ abhängig (vgl. \cite{MorNoc}) und daher wird dabei von "`Daten-Oszillation"' gesprochen.
\end{bem}


Der Oszillationsterm $\osc_1 (u_{\mcal S},\psi)$ ist ein Maß für die \idx{Oszillation} zwischen dem Hindernis $\psi$ und der Galerkin-Lösung $u_{\mcal S}$, d.h.
\begin{align*}
	\osc_1(u_{\mcal S},\psi) \coloneqq \(\sum_{p \in \mcal N^{0+}} \norm{\nabla (\psi - u_{\mcal S})}_{0,\omega_p}^2\)^{\frac 12} ,
\end{align*}
wobei $\mcal N^{0+} \coloneqq \{p \in \mcal N^0 \mid u_{\mcal S} > \psi \text{ in }\omega_p \setminus \{p\}\}$ ist, also die Menge der \textit{isolierten Kontaktknoten}, d.h. $u_{\mcal S}$ ist auf der Menge $\omega_p$ nur im Punkt $p$ mit $\psi$ in Kontakt. Anschaulich stellt $\osc_1 (u_{\mcal S},\psi)$ deshalb ein Maß für die Hindernisoszillation dar, weil wegen der Linearität von $u_{\mcal S} ,\psi$ folgt, dass eine größere Differenz zwischen $\psi$ und $u_{\mcal S}$ auch einen größeren Gradienten $\nabla (\psi-u_{\mcal S})$ impliziert und damit auch eine größere Oszillation $\osc_1(u_{\mcal S},\psi)$.

Das kontinuierliche Gegenstück zu $\mcal N^{0+}$ ist die Menge der \textit{isolierten Kontaktpunkte} $x_c$, die aufgrund von $u-\psi >0$ für alle $x \in \mcal U(x_c, \eps) \subset \Omega$ mit $u(x_c) = \psi(x_c)$ alle strikten Minima $x_c \in \Omega$ von $u-\psi$ enthält. Daraus folgt, dass $(\nabla u -\nabla \psi) = 0$ ist für alle isolierten Kontaktpunkte, wenn $u, \psi$ hinreichend glatt sind.

Stellt nun $\psi$ nur eine lineare Approximation an ein hinreichend glattes Hindernis dar, so folgt mit den Aussagen aus Theorem  \ref{theorem:3.16} und Theorem 2 in \cite{Zhang}, dass wegen der Konvergenz der diskretisierten Ränder für einen isolierter Kontaktknoten $p \in \mcal N^{0+}$, der bei
Verfeinerung bestehen bleibt, ein für die exakte Lösung $u$ korrespondierender Kontaktpunkt $\tilde p$ existiert und es gilt
\begin{align*}
	\bigcup_{p \in \mcal N^{0+}} \omega_p \xrightarrow[h\ra 0]{} \tilde p \, .
\end{align*}
Sind $u$ und $\psi$ also hinreichend glatt, so verschwindet der Oszillationsterm $\osc_1(u_{\mcal S},\psi)$ für $h\ra 0$.

% damit gilt $\osc_1$ hat wenigstens den Grad vom Fehler $e$ (warum?)


Der Oszillationsterm $\osc_2(u_{\mcal S}, \psi, f)$ ist auf zwei Mengen definiert:
\begin{align}\label{eq:4.25}
	\mcal N^{++} \coloneqq \{p \in \mcal N^{+}\mid \rho_E \ge - d_E \, \forall \, E \in \mcal E_p\} \, ,
\end{align}
d.h. alle Knoten ohne Kontakt, in denen der Fehler $\eps_{\mcal V}$ nicht in Kontakt mit dem Hindernis aus $\mcal A_{\mcal V}$ steht (wie in Beweis von Satz \ref{satz:4.11} ersichtlich) und
\begin{align}\label{eq:4.26}
	\mcal N^{0-}\coloneqq \{ p \in \mcal N^0 \mid u_{\mcal S} = \psi , f \le 0 \text{ auf } \omega_p, j_E \le 0 \, \forall \, E \in \mcal E_p \} \, ,
\end{align}
d.h. die Kontaktknoten mit vollem Kontakt, sodass die Kraft $f$ eine Drucklast ist und negativer Normalenfluss $j_E$ herrscht (vgl. auch \cite{SiebVee} Gleichung (2.11)).


Aus der Nebenbedingung von $\mcal N^{0-}$ folgt
\begin{align*}
	0 \ge f + \sum_{E \in \mcal E_p} j_E
\end{align*}
Durch Multiplikation mit geeigneten Testfunktionen $v$ und Integration über $\omega_p$ ergibt
\begin{align*}
	0 &  \ge \int_{\omega_p} f v \, dx + \sum_{E\in \mcal E_p} \int_E j_E v \, ds \\
	& = \int_{\omega_p} f v \, dx - \int_{\omega_p} \underbrace{\nabla u_{\mcal S}}_{=\nabla \psi} \nabla v \, dx
\end{align*}
und damit gilt
\begin{align}\label{eq:4.27}
	 \int_{\omega_p} {\nabla \psi} \nabla v \, dx \ge \int_{\omega_p} f v \, dx \, .
\end{align}
Es gilt also mit \eqref{eq:4.27} laut Satz \ref{satz:3.4}, dass $-\Delta \psi - f \ge 0$ auf $\omega_p$ im distributionellem Sinne (vgl. auch \cite{Walker} Kapitel 3) ist. Dies ist laut Satz \ref{satz:3.4} auch notwendig, damit $u = \psi$ auf $\omega_p$ gilt.


Mit den Mengen \eqref{eq:4.25} und \eqref{eq:4.26} ist der Oszillationsterm $\osc_2 (u_{\mcal S}, \psi, f)$ definiert als
\begin{align*}
	\osc_2(u_{\mcal S},\psi, f) \coloneqq \(\sum_{p \in \mcal N^{++}} h_p^2\, \norm{f-\bar f_p}_{0,\omega_p}^2 + \sum_{p \in \mcal N\setminus (\mcal N^{0-}\cup \mcal N^{++})} h_p^2 \, \norm f_{0,\omega_p}^2 \)^{\frac 12}, 
\end{align*}
wobei $h_p \coloneqq \max_{E\in \mcal E_p} \abs E$ für jedes $p \in \mcal N$ ist, $h_p$ ist ein Maß für den Durchmesser von $\omega_p$, und $\bar f_p$ den Mittelwert von $f$ über $\omega_p$ bezeichne, also
\begin{align*}
	\bar f _p = \frac 1{\abs{\omega_p}} \int_{\omega_p} f \, dx \, .
\end{align*}
Anschaulich kann man die Summanden der ersten Summe als Varianz der Last $f$ auf $\omega_p$ interpretieren. Da wir in der Variationsrechnung ein gemitteltes Problem betrachten, ist die erste Summe also ein Maß dafür, auf welchen Teilen von $\Omega$ die wirkliche Last $f$ um einen gemittelten Wert oszilliert. Dies impliziert bei starker Oszillation anschaulich, dass eine Verfeinerung in solchen Gebieten, die Lösung genauer machen würde.

In der Menge $\mcal N\setminus (\mcal N^{0-}\cup \mcal N^{++})$ sind die inneren Knoten, die keinen vollen Kontakt $u_{\mcal S} = \psi$ auf $\omega_p$ haben und für die die Lösung $\eps_{\mcal V}$ des lokalen Defektproblems keinen Kontakt mit der Nebenbedingung von $\mcal A_{\mcal V}$ hat. Man beachte also, dass in $\mcal N\setminus (\mcal N^{0-}\cup \mcal N^{++})$ nur die Kontaktknoten fehlen, die vollen  Kontakt haben, und die Nichtkontaktknoten, für die $\eps_{\mcal V}$ in Kontakt mit dem Hindernis aus $\mcal A_{\mcal V}$ stehen. Diese Menge beschreibt gerade die Randpunkte am Hindernis und $\osc_2 (u_{\mcal S},\psi,f)$ enthält nur Anteile aus Knoten ohne vollen Kontakt, da für diese die Varianz bzgl. des Lastvektors $f$ irrelevant wäre, denn hier würde nach Verfeinerung immer noch voller Kontakt herrschen.


\begin{bem*}
Die \idx{Oszillationsterme} können leicht berechnet bzw. implementiert werden, wie man in Kapitel \ref{kap:5} oder auch Anhang \ref{anhang:D} nachvollziehen kann.
\end{bem*}


Im unbeschränkten Fall, also $\psi = -\infty$, ist $\eps_{\mcal V}$ nicht im Kontakt mit dem Hindernis für alle Knoten aus $\mcal N$ und damit gilt $\mcal N^{++} = \mcal N\cap \Omega$. Wir rechnen nach, dass dann für die Menge der Randpunkte gilt:
\[
	\mcal N\setminus (\mcal N^{0-}\cup \mcal N^{++}) = \mcal N \setminus (\mcal N \cap \Omega) = \mcal N \cap \partial \Omega \, .
\]
Also erhalten wir für den Oszillationsterm $\osc_2(u_{\mcal S},\psi,f)$ die Form
\begin{align*}
	\osc_2(u_{\mcal S},\psi, f) = \(\sum_{p \in \mcal N\cap \Omega} h_p^2 \norm{f-\bar f_p}_{0,\omega_p}^2 + \sum_{p \in \mcal N \cap \partial \Omega} h_p^2 \norm f_{0,\omega_p}^2 \)^{\frac 12} ,
\end{align*}
was der Daten-Oszillation aus dem unbeschränkten Fall entspricht. Damit ist der zweite Oszillationsterm aus \eqref{eq:4.24} also eine Verallgemeinerung des unbeschränkten Falles. Wenn also der Teil ohne Kontakt  bekannt wäre, dann wäre der beschränkte Fall auf dieser Menge von Knoten äquivalent zu einem unbeschränkten \idx{Dirichtlet-Problem}.







\subsection{Zuverlässigkeit des Fehlerschätzers}
\label{kap:4.1.4}

Wir werden in diesem Kapitel eine obere Schranke für den Fehler im Energiefunktional $-\mcal I(e)$, die vom hierarchischen Fehlerschätzer $-\mcal I_{\mcal Q}(\eps_{\mcal V})$ abhängt, herleiten. Hierfür sind zunächst Eigenschaften für die Interpolation von $e$ auf $\eps_{\mcal V}$ notwendig.

Die Reduktion des Fehlers $e = u-u_{\mcal S} \in H^1_0(\Omega)$ auf den approximierten Fehler $\eps_{\mcal V}\in \mcal V$ erhalten wir durch lokale Projektionen für jedes $p \in \mcal N$ mit
\begin{align*}
	\pi_p: H^1(\Omega) \ra \mcal Q_p = \Span \{ \phi_p\} \cup \mcal V_p \, , \quad \mcal V_p = \Span\{\phi_E \mid E \in \mcal E_p\} \, .
\end{align*}
Die lokalen Projektionen $\pi_p$ sind für jedes $v \in H^1(\Omega)$ aus Dimensionsgründen ($\dim (\mcal Q_p) = p+1$) eindeutig bestimmt durch
\begin{align}\label{eq:4.32}
	\int_E \pi_p v \, ds = \int_E v \, ds \quad \forall \, E \in \mcal E_p \text{ und } \begin{cases}
														\int_{\omega_p} \pi_p v \, dx = \int_{\omega_p}  v \, dx  &,  p \in \mcal N^{++} \\
														0  &, \text{sonst}
													\end{cases}  .
\end{align}


Zunächst zeigen wir ein Resultat, das uns die Koordinaten für das Bild der lokalen Projektion $\pi_p$ in einer Basis von $\mcal Q_p$ liefert.


\begin{lemma}\label{lem:4.19}
Es sei $\pi_p$ die oben beschriebene Projektion. Dann gelten für die Koordinaten bzgl. der Basis $\{\phi_p\}\cup \{\phi_E \mid E \in \mcal E_p\}$ von 
\[
	\pi_p v = \alpha_p(v) \phi_p + \sum_{E \in \mcal E_p} \alpha_E(v) \phi_E
\]
die Beziehungen
\begin{subequations}\label{eq:4.33}
\begin{align}\label{eq:4.33a}
	\alpha_p(v)& = \begin{cases}
					\frac{c_p(v)}{c_p(\phi_p)} &, p \in \mcal N^{++} \\
					0 &, \text{sonst}
				\end{cases} , \\
	\label{eq:4.33b}
	 \alpha_E(v) &= \frac{\int_E v \, ds - \alpha_p(v)\int_E \phi_p \, ds}{\int_E \phi_E \, ds} \, ,
\end{align}
\end{subequations}
wobei
\begin{align*}
	c_p(v) = \int_{\omega_p} v \, dx - \sum_{E\in \mcal E_p} \(\int_E v \, ds\) \(\int_{\omega_p} \phi_E \, dx\)\(\int_E \phi_E \, ds\)^{-1}
\end{align*}
Insbesondere gilt $c_p(\phi_p) = -\frac 16\, \abs{\omega_p}$.
\end{lemma}

\begin{proof}
Für eine bessere Übersicht im Beweis werden wir die Differentialformen $dx$ und $ds$ weg. Es sei $v \in H^1(\Omega)$ beliebig. Dann gilt für jede Kante $E \in \mcal E_p$ mit
\[
	\pi_p v = \alpha_p(v) \phi_p + \alpha_E (v) \phi_E \in \mcal Q_p 
\]
nach \eqref{eq:4.32}, dass
\begin{align}\notag
	 & \int_Ev  = \int_E \pi_p v  = \int_E \alpha_p(v) \phi_p + \alpha_E(v) \phi_E \\
	\label{eq:4.34}
	\lra \,  &  \alpha_E(v)= \(\int_E v - \alpha_p(v) \int_E \phi_p \)\( \int_E \phi_E \)^{-1} \, .
\end{align}
Wenn $p \not\in \mcal N^{++}$ ist, so gilt $\pi_p v \in \mcal V_p = \Span\{\phi_E\mid E \in \mcal E_p\}$, d.h. $\alpha_p(v) = 0$.

Es sei nun also $p \in \mcal N^{++}$. Dann folgt aus der zweiten Eigenschaft von \eqref{eq:4.32} und \eqref{eq:4.34} für $\pi_p v = \alpha_p(v) \phi_p + \sum_{E\in \mcal E_p} \alpha_E(v) \phi_E\in \mcal Q_p$
\begin{align*}
	\int_{\omega_p} v    =& \int_{\omega_p} \pi_p v  = \int_{\omega_p} \alpha_p(v) \phi_p + \sum_{E\in \mcal E_p} \alpha_E(v) \phi_E \\
	 =& \alpha_p(v) \int_{\omega_p} \phi_p  + \sum_{E\in \mcal E_p} \alpha_E(v) \int_{\omega_p}\phi_E  \\
	= & \alpha_p(v) \int_{\omega_p} \phi_p  + \sum_{E\in \mcal E_p} \(\int_E v  - \alpha_p(v) \int_E \phi_p \)\( \int_E \phi_E\)^{-1} \( \int_{\omega_p}\phi_E\) \\
	 =& \alpha_p(v) \Bigg(\underbrace{\int_{\omega_p} \phi_p-\sum_{E\in \mcal E_p}\( \int_E \phi_p\)\( \int_{\omega_p} \phi_E \)\(\int_E \phi_E\)^{-1}}_{= c_p(\phi_p)}\Bigg) \\
	 & + \sum_{E\in\mcal E_p} \(\int_E v\) \(\int_{\omega_p} \phi_E\) \(\int_E \phi_E\)^{-1} \, .
\end{align*}
Nach dem Umformen nach $\alpha_p(v)$ ergibt sich dann
\[
	\alpha_p(v) = \frac{c_p(v)}{c_p(\phi_p)}
\]
mit dem oben definierten $c_p(\cdot)$.

Es bleibt also zu zeigen, dass $c_p(\phi_p) = -\frac 1 6 \, \abs{\omega_p}$. Hierfür betrachten wir die einzelnen Summanden von $c_p(\phi_p)$. Zunächst berechnet das Integral von $\phi_p$ über $\omega_p$ das Volumen der von $\phi_p$ erzeugten Pyramide mit Grundfläche $\abs{\omega_p}$, d.h.
\begin{align}\label{eq:4.35}
	\int_{\omega_p} \phi_p = \frac 13 \, \abs{\omega_p} \, .
\end{align}
Weiter ist $\phi_p$ auf jeder Kante $E \in \mcal E_p$ eine von 1 zu 0 abfallende Gerade und damit ist das Integral über $E$ gerade der Flächeninhalt vom darüber liegenden Dreieck, also
\begin{align}\label{eq:4.36}
	\int_E \phi_p = \frac 1 2 \, \abs E \, .
\end{align}
Die letzten beiden Integrale berechnen wir über die Referenzelemente in $\R$ oder $\R^2$ für das Kurven- bzw. Flächenintegral. Die Funktion $\phi_E$ über eine Kante $E$ ist eine nach unten geöffnete Parabel. Auf dem Referenzelement $[-1,1]\subset\R$ ist dies die Funktion
\[
	\hat \phi_E = 1-\xi^2 
\]
und mit einer affinen Transformation $s: [-1,1]\ra [a,b] = E, s(\xi) = \frac{b-a}2 \xi + \frac{b+a}2$ lässt sich das Referenzelement auf das Element $E$ abbilden. Damit ergibt sich mit dem Transformationssatz der Integration
\begin{align}\label{eq:4.37}
	\int_E \phi_E = \frac{b-a}2 \int_{-1}^1 \hat\phi_E = \frac 12 \, \abs{E} \cdot \frac 43 = \frac 23 \, \abs E\, .
\end{align}
Der letzte Fall ist komplizierter zu beschreiben. Zunächst sei erwähnt, dass $\supp (\phi_E) = T_i \cup T_j, T_i,T_j \subset \omega_p, i\not=j$ gilt, $\phi_E$ also nur auf zwei Dreiecken, die in $\omega_p$ enthalten sind, ungleich Null ist. Damit wird für jede Kante $E \in \mcal E_p$ über jedes Dreieck $T \subset \omega_p$ genau zweimal integriert.

Auf dem Referenzelement 
\[	
	\hat T \coloneqq \{(\xi,\eta)\in \R^2 \mid 0\le \xi \le 1, 0 \le \eta \le 1-\xi\}
\]
haben wir die drei Bubble-Funktionen
\begin{align*}
	\hat \phi_{E_1} = 4 \xi (1-\xi-\eta) \, , \quad \hat \phi_{E_2} = 4 \xi \eta \, , \quad \hat \phi_{E_3} = 4 \eta (1-\xi-\eta) \, ,
\end{align*}
für die man leicht nachrechnen kann, dass
\begin{align*}
	\int_{\hat T} \hat\phi_{E_1} = \int_{\hat T} \hat\phi_{E_2} = \int_{\hat T} \hat\phi_{E_3} = \frac 16
\end{align*}
gilt. Es sei nun $J_T$ die Jacobi-Determinante bzgl. einer affinen Transformation $r:\hat T \ra T$, dann gilt nach Transformationssatz mit einem $T \subset \supp(\phi_E)$
\[
	\int_T \phi_E = \abs{J_T} \int_{\hat T} \hat \phi_E = \frac 16 \, \abs{J_T} \, .
\]
Weiter rechnen wir nach, dass
\[
	\abs T = \int_T dx = \abs{J_T} \int_{\hat T} dx = \frac 12 \, \abs{J_T} \, \lra \, \abs{J_T} = 2 \, \abs{T} 
\]
gilt und damit folgt insgesamt zusammen mit \eqref{eq:4.35} bis \eqref{eq:4.37}
\begin{align*}
	c_p(\phi_p) & = \int_{\omega_p} \phi_p - \sum_{E\in\mcal E_p} \(\int_E \phi_p\) \(\int_{\omega_p} \phi_E \)\(\int_E \phi_E\)^{-1} \\
	& = \frac 1 3 \, \abs{\omega_p} - 2 \sum_{T \subset \omega_p} \frac 1 2 \, \abs E \cdot \frac 1 6 \, \abs{J_T} \cdot \frac 3 2 \, \abs E^{-1} \\
	& = \frac 1 3 \, \abs{\omega_p} - \sum_{T\subset \omega_p} \frac 12 \, \abs T = \( \frac 1 3  -  \frac 1 2 \)\abs{\omega_p} \\
	& = - \frac 16 \, \abs{\omega_p} \, . \qedhere
\end{align*}
\end{proof}

Für das zentrale Lemma in diesem Kapitel benötigen wir noch eine Abschätzung für die Koordinaten der lokalen Projektionen.

\begin{lemma}\label{lem:4.21}
Die Koeffizienten in \eqref{eq:4.33} erfüllen die Eigenschaft
\begin{align}\label{eq:my4.39}
	\max_{\mcal Q \in \{p\} \cup \mcal E_p} \abs{\alpha_{\mcal Q} (v)} \lesssim h^{-1}_p (\norm v_{0,\omega_p} + h_p \norm{\nabla v}_{0,\omega_p}) 
\end{align}
und $\pi_p$ ist stabil im Sinne von
\begin{align}\label{eq:my4.40}
	\norm{\pi_p v}_{0,\omega_p} \lesssim \norm v_{0,\omega_p} + h_p \norm{\nabla v}_{0,\omega_p} \, .
\end{align}
Insbesondere gilt, wenn $p \not\in \mcal N^{++}$ ist, dass für $\alpha_E(v) = \(\int_{E} v \, ds \) \(\int_E \phi_E\)^{-1}$ die Eigenschaft gilt:
\begin{align}\label{eq:my4.41}
	\int_E v \, ds \ge \int_E (\psi-u_{\mcal S}) \, ds \lra \alpha_E(v) \gtrsim \psi(x_E)-u_{\mcal S} (x_E) \quad \forall \, E \in \mcal E_p \, .
\end{align}
\end{lemma}

\begin{proof}
Unter Verwendung der \index{Cauchy-Schwar'sche Ungleichung} Cauchy-Schwarz'schen Ungleichung und einer Anwendung vom \idx{Spursatz} (s. Theorem \ref{theorem:A.9}) erhalten wir zunächst
\begin{align*}
	\Abs{\int_{\omega_p} v \, dx} & \stackrel{\scriptsize\text{C.S.}}\le \underbrace{\(\int_{\omega_p} dx\)^{\frac 12}}_{=\abs{\omega_p}^{\frac 12}} \(\int_{\omega_p} v^2 \, dx\)^{\frac 12} \lesssim h_p \norm{v}_{0,\omega_p} \, , \\
	\Abs{\int_{E} v \, ds} & \stackrel{\scriptsize\text{C.S.}}\le \underbrace{\(\int_E ds\)^{\frac 12}}_{=\abs E^{\frac 12}\le h_p^{\frac 12}} \underbrace{\(\int_E v^2 \, ds\)^{\frac 12}}_{=\norm v_{0,E}} \stackrel{\scriptsize\text{Spursatz}}\lesssim h_p(h_p^{-1} \norm v_{0,\omega_p} + \norm{\nabla v}_{0,\omega_p}) \, .
\end{align*}
Analog zum Beweis von Lemma \ref{lem:4.19} können wir für $\phi_p$ und $\phi_E$ berechnen, dass die Integrale jeweils über $E$ sowie $\omega_p$ von den Gebieten und einer weiteren Konstanten abhängen und damit also "`$\approx h_p$"' sind. Durch Anwendung der Dreiecksungleichung sowie den eben erwähnten Integralen lässt sich damit berechnen, dass
\[
	\abs{\alpha_p (v)} \lesssim \norm v_{0,\omega_p} + h_p \norm{\nabla v}_{0,\omega_p}
\]
gilt. Dies in \eqref{eq:4.33b} eingesetzt, ergibt dann wieder unter Verwendung der Dreiecksungleichung und der endlichen Integrale von $\phi_p,\phi_E$ sowie der obigen Abschätzungen die Schranke
\[
	\abs{\alpha_E(v)} \lesssim h_p^{-1} (\norm v_{0,\omega_p} + h_p \norm{\nabla v}_{0,\omega_p})
\]
und damit folgt \eqref{eq:my4.39}. 


Die Abschätzung \eqref{eq:my4.40} folgt direkt aus den Abschätzungen von \eqref{eq:my4.39} zusammen mit der Koordinatendarstellung
\[
	\pi_p v = \alpha_p(v) \phi_p + \sum_{E \in \mcal E_p} \alpha_E(v) \phi_E
\]
der lokalen Projektion und vorheriger Anwendung der Dreiecksungleichung auf die Norm $\norm{\pi_p v}_{0,\omega_p}$.


Es sei $P \not\in \mcal N^{++}$. Dann gilt wegen \eqref{eq:4.33a} $\alpha_p(v) = 0$ und damit mit \eqref{eq:4.33b}
\[
	\alpha_E(v) = \(\int_E v \, ds\) \(\int_E\phi_E \, ds\)^{-1} .
\]
Da $\psi$ wegen Voraussetzung \ref{vor:4.1} stückweise linear ist, gilt dies auch für $\psi-u_{\mcal S}$, d.h. die Funktion stellt eine Gerade über der Kante $E$ dar. Mit der Mittelpunktsregel der Quadratur (vgl. \cite{Stoer} Kapitel 3) ergibt sich dann also
\[
	\int_E (\psi-u_{\mcal S}) \, ds = \abs E \, (\psi(x_E) -u_{\mcal S}(x_E)) \, .
\]
Wie wir im Beweis von Lemma \ref{lem:4.19} nachgerechnet haben, gilt $\int_E \phi_E \, ds = \frac 23 \abs E$ und dann ist unter der Voraussetzung von \eqref{eq:my4.41}
\begin{align*}
	\psi(x_E) -u_{\mcal S}(x_E) &= \frac 3 2\abs E^{-1} \int_E (\psi-u_{\mcal S}) \, ds \\
	& \lesssim \(\int_E \phi_E \, ds\)^{-1} \(\int_E v \, ds\) \\
	& = \alpha_E(v) \, . \qedhere
\end{align*}
\end{proof}


Jetzt haben wir das komplette Werkzeug, um das zentrale Lemma zum Beweis einer oberen Schranke für $J(u_{\mcal S})-J(u)$ bzgl. $-\mcal I_{\mcal Q}(\eps_{\mcal V})$ zu zeigen. Da wir gesehen haben, dass $-\mcal I (e)$ äquivalent zum \idx{Fehlerindikator} $\rho_{\mcal S}(e)$ ist, leiten wir für diesen im folgenden Lemma  eine obere Schranke her.


\begin{lemma}\label{lem:4.21}
Es sei Voraussetzung \ref{vor:4.1} erfüllt. Dann gilt
\begin{align}
	\rho_{\mcal S}(e) \lesssim \sum_{E\in \mcal E} \eta_E \, \abs{\rho_E} + \osc(u_{\mcal S},\psi,f)^2 
\end{align}
mit $\rho_E$ wie in \eqref{eq:4.11}, $\osc (u_{\mcal S},\psi,f)$ wie in \eqref{eq:4.24} und $\eta_E = \abs{\eps_{\mcal V}(x_E)} \, \norm{\phi_E}$.
\end{lemma}

\begin{proof}
Die Idee des Beweises beruht auf Gleichung \eqref{eq:4.20}; damit können wir den Indikator in die lokalen Anteile bzgl. der Punkte $p \in \mcal N$ aufteilen, d.h.
\begin{align}\label{eq:4.40}
	\rho_{\mcal S} (e) = \sum_{p \in \mcal N} \rho_p (e) \, .
\end{align}
Hierbei ist die Abschätzung der lokalen Anteile $\rho_p(e)$ abhängig von einer Anwendung der Poincaré-Friedrichungleichung (Satz \ref{satz:2.13}), die auf die \textit{verallgemeinerte \idx{Poincaré-Friedrich-Ungleichung}}\index{Ungleichungen!Poincaré}\index{\idx{Poincaré-Friedrich-Ungleichung}!verallgemeinerte} (vgl. auch \cite{Rudin})
\begin{align}\label{eq:4.41}
	\norm{v-c}_{0,\omega_p} \lesssim h_p \norm{\nabla v}_{0,\omega_p}
\end{align}
mit einer Konstanten $c$ und $v\in H^1(\Omega)$, so dass $v=c$ auf einer Menge $\Gamma \subset \partial \omega_p$ mit einem Maß $\mu (\Gamma)\not= 0$ gilt, führt. Da \eqref{eq:4.41} von $p\in \mcal N$ abhängt, werden wir sehen, dass die Anwendung von der \idx{Poincaré-Friedrich-Ungleichung} vom Typ des Knotens $p$ abhängt. Deshalb betrachten wir die disjunkte Vereinigung
\begin{align}\notag
%\begin{aligned}
	& \overbrace{\mcal N^{++} \cup (\mcal N^+ \setminus \mcal N^{++})}^{=\mcal N^+} \cup (\mcal N \cap \partial \Omega ) \cup\overbrace{ (\mcal N^0 \setminus (\mcal N^{0+} \cup \mcal N^{0-}))  \cup \mcal N^{0+} \cup \mcal N^{0-}}^{= \mcal N^0} \\
	\label{eq:4.42}
	= \, & \mcal N^+ \cup \mcal N^0 \cup (\mcal N \cap \partial \Omega)  = (\mcal N \cap \Omega) \cup (\mcal N \cap \partial \Omega) = \mcal N \, .
%\end{aligned}
\end{align}
Wir wollen im Folgenden die in \eqref{eq:4.42} aufgeführten Fälle chronologisch abarbeiten.

\textit{Fall 1}: Es sei $p \in \mcal N^{++}$. Wir behaupten, dass
\begin{align}\label{eq:4.46}
	\rho_p(e) \lesssim \(\sum_{E\in \mcal E^+_p} \abs{\rho_E} + h_p \norm{f-\bar f_p}_{0,\omega_p} \) \norm {\nabla e}_{0,\omega_p}
\end{align}
gilt, wobei $\mcal E^+_p = \{E \in \mcal E_p \mid \rho_E \ge -d_E\}$. Da $p \in \mcal N^{++}$ ist, gilt für alle $E\in \mcal E_p$ die Ungleichung $\rho_E \ge -d_E$ ist, d.h. $\mcal E^+_P = \mcal E_p$. Wir setzen
\[
	w = (e-c)\phi_p \, , \quad c = \frac 1{\abs{\omega_p}} \int_{\omega_p} e\, dx \, .
\]
Da $\mcal N^{++} \subset \mcal N^+ \cap \Omega$ ist, d.h. $u_{\mcal S}(p) > \psi (p)$ ist,  gilt  
\begin{align*}
	\rho_p(c) = c \, \rho_p(1) \stackrel{\scriptsize\eqref{eq:4.22b}}= c\cdot 0 = 0 \, .
\end{align*}
Damit erhalten wir
\begin{align}\notag
	\rho_p (e) & = \rho_p(e) - \rho_p(c) = \rho_p(e-c) \stackrel{\scriptsize \text{Lem. \ref{lem:4.14}}}= \int_{\omega_p} fw \, dx + \sum_{E\in \mcal E_p} \int_E j_E w \, ds \\
	\notag
	&\!\! \!\stackrel{\scriptsize \text{"`}+0\text{"'}}= \int_{\omega_p} f \pi_p w \, dx + \sum_{E\in \mcal E_p}\underbrace{ \int_E j_E \pi_pw \, ds}_{\stackrel[\scriptsize\eqref{eq:4.32}]{}= \int_E j_Ew \, ds} + \int_{\omega_p} f(w-\pi_p w) \, dx \\
	\notag
	& = \rho_{\mcal S} (\pi_pw ) +  \int_{\omega_p} f(w-\pi_p w) \, dx - \bar f_p \underbrace{ \int_{\omega_p} (w-\pi_p w) \, dx }_{= 0 \text{ wegen } \eqref{eq:4.32}} \\
	\notag
	& = \rho_{\mcal S} (\pi_pw ) +  \int_{\omega_p} (f-\bar f_p)(w-\pi_p w) \, dx \\
	\label{eq:4.47}
	& \!\!\! \; \; \!\! \stackrel{\scriptsize \text{C.S.}}\le \sum_{E \in \mcal E_p} \alpha_E(w) \rho_E \norm{\phi_E} + \norm{f-\bar f_p}_{0,\omega_p} \norm{w-\pi_p w}_{0,\omega_p} \, , 
\end{align}
wobei im letzten Schritt zusätzlich zur Cauchy-Schwarz-Ungleichung im zweiten Summanden noch angewendet wurde, dass
\begin{align*}
	\rho_{\mcal S} (\pi_p w) &= \rho_{\mcal S} \(\alpha_p(w) \phi_p + \sum_{E\in \mcal E_p} \alpha_E(w) \phi_E\) \\
	& = \alpha_p(w) \underbrace{\rho_{\mcal S} (\phi_p)}_{=\rho_p(1) = 0} \sum_{E\in \mcal E_p} \alpha_E(w) \!\!\!\! \underbrace{\rho_{\mcal S}(\phi_E)}_{\stackrel[\scriptsize \eqref{eq:4.11}]{}=\rho_E \norm{\phi_E}} \\
	& = \sum_{E \in \mcal E_p} \alpha_E(w) \rho_E\norm{\phi_E}
\end{align*}
ist. Da $\norm{\phi_p}_{\infty,\omega_p} \le 1$, gilt mit der \idx{Poincaré-Friedrich-Ungleichung} \eqref{eq:4.41}
\begin{align}\label{eq:4.48}
	\norm w_{0,\omega_p} = \norm{(e-c)\phi_p}_{0,\omega_p} \le \norm{e-c}_{0,\omega_p} \lesssim h_p \norm{\nabla e}_{0,\omega_p} \, ,
\end{align}
wobei die erste Ungleichung aus dem Mittelwertsatz der Integralrechnung folgt.
Es sei weiterhin darauf hingewiesen, dass $\norm{\nabla \phi_p}_{\infty,\omega_p} \lesssim h^{-1}_p$, da die Steigung der Hutfunktion nur von der Form von $\omega_p$ abhängt. Damit erhalten wir dann durch Anwenden von \eqref{eq:my4.39} für alle $E \in \mcal E_p$
\begin{align}
\begin{aligned}\label{eq:4.49}
	\abs{\alpha_E(w)} & \lesssim h_p^{-1} (\norm{w}_{0,\omega_p} + h_p \norm{\nabla w}_{0,\omega_p}) \\
	& = h_p^{-1} (\norm{(e-c)\phi_p}_{0,\omega_p} + h_p \norm{\nabla ((e-c)\phi_p)}_{0,\omega_p}) \\
	& \le h_p^{-1} (h_p \norm{\nabla e}_{0,\omega_p} + h_p \norm{\underbrace{\nabla(e-c)}_{=\nabla e} \phi_p + (e-c) \nabla \phi_p}_{0,\omega_p}) \\
	& \! \;\!\!\stackrel{\triangle \not=}\le \norm{\nabla e}_{0,\omega_p} + \norm{\nabla e \, \phi_p}_{0,\omega_p}+ \norm{(e-c) \nabla \phi_p}_{0,\omega_p} \\
	& \lesssim 2 \, \norm{\nabla e}_{0,\omega_p} + h_p^{-1} \norm{e-c}_{0,\omega_p} \stackrel{\scriptsize \eqref{eq:4.48}} \lesssim  \norm{\nabla e}_{0,\omega_p} \, .
\end{aligned}
\end{align}
Über das Referenzelement $\hat T$ kann man zeigen, dass
\[
	\norm{\phi_E}  = a(\phi_E,\phi_E)^{\frac 1 2} =\(\int_{\Omega} \nabla \phi_E \nabla \phi_E \, dx \)^{\frac 12} = \(\frac 83 (\abs{J_{T_1}}+\abs{J_{T_2}})\)^{\frac 12} \lesssim \tilde c \, ,
\]
da die Jacobi-Determinanten $J_{T_1},J_{T_2}$ (wobei $E \subset T_i,i=1,2$ gilt) endlich sind, jedoch von der Form von $\omega_p$ abhängen. Damit gilt
\begin{align}\label{eq:4.50}
	\norm{\nabla e}_{0,\omega_p} \approx \norm{\phi_E}^{-1} \norm{\nabla e}_{0,\omega_p} \, .
\end{align}
Analog folgt mit Anwendung von \eqref{eq:my4.40} und \eqref{eq:4.48}, dass gilt:
\begin{align}\label{eq:4.51}
\begin{aligned}
	\norm{w-\pi_p w}_{0,\omega_p} &\! \;\!\!\stackrel{\scriptsize \triangle \not=} \le \norm w_{0,\omega_p} + \norm{\pi_p w}_{0,\omega_p} \\
	& \lesssim h_p\norm{\nabla e}_{0,\omega_p}+\norm w_{0,\omega_p} + h_p \norm{\nabla e}_{0,\omega_p} \lesssim h_p \norm{\nabla e}_{0,\omega_p}
\end{aligned}
\end{align}
Setzen wir \eqref{eq:4.49} bis \eqref{eq:4.51} in \eqref{eq:4.47}, so folgt nach Ausklammern von $\norm{\nabla e}_{0,\omega_p}$ die Behauptung \eqref{eq:4.46} mit $\mcal E_p = \mcal E_p^+$.

\textit{Fall 2}: Es sei $p \in \mcal N^+\setminus \mcal N^{++}$. Wir behaupten, dass gilt:
\begin{align}\label{eq:4.52}
	\rho_p (e) \lesssim \(\sum_{E \in \mcal E^+_p} \abs{\rho_E} + h_p \norm f_{0,\omega_p}\) \norm{\nabla e}_{0,\omega_p} \, .
\end{align}
Auch hier können wir analog zu \eqref{eq:4.47} eine Ungleichung herleiten, wobei die zweite Addition der Null nicht gilt, da $p \not \in \mcal N^{++}$. Damit erhalten wir die Aussage
\begin{align}\label{eq:4.53}
	\rho_p (e) \le \sum_{E\in \mcal E_p} \alpha_E (w) \rho_E \norm{\phi_E} + \norm f_{0,\omega_p} \norm{w-\pi_p w}_{0,\omega_p} \, ,
\end{align} 
wobei wir hier
\begin{align}\label{eq:4.54}
	w = (e-c)\phi_p\, , \quad c = \min\left\{ \(\int_E e\phi_p \, ds \)\(\int_E \phi_p\, ds\)^{-1} \mid E \in \mcal E_p \right\}
\end{align}
setzen. Damit gilt
\begin{align*}
	\alpha_E(w) & = \(\int_E w \, ds \) \(\int_E \phi_E\, ds\)^{-1} = \(\int_E (e-c)\phi_p \, ds \) \(\int_E \phi_E\, ds\)^{-1} \\
	& = \(\int_E e\phi_p \, ds-c\int_E \phi_p \, ds \) \(\int_E \phi_E\, ds\)^{-1} \\
	&\!\!\!\!\!\;\stackrel{\scriptsize \eqref{eq:4.54}}\ge \!\!\; \!\frac{\int_E e\phi_p \, ds-\(\int_E e\phi_p \, ds \)\(\int_E \phi_p\, ds\)^{-1} \(\int_E \phi_p \, ds \)}{\int_E \phi_E\, ds} \\
	& = 0 \, .
\end{align*}
Daraus können wir folgern, dass für die Kanten $E\in \mcal E_p$ mit $\rho_E < -d_E \le 0$
\[
	\alpha_E(w)\rho_E \le 0
\]
gilt. Ersetzen wir dies in \eqref{eq:4.53}, so folgt \eqref{eq:4.52} insgesamt mit denselben Abschätzungen aus \eqref{eq:4.49}, \eqref{eq:4.50} und \eqref{eq:4.51}.

\textit{Fall 3}: Sei $p \in \mcal N \cap \partial \Omega$. Wir behaupten für diesen Fall, dass
\begin{align}\label{eq:4.55}
	\rho_p (e) \lesssim \sum_{E\in \mcal E^0_p} d_E \, \abs{\rho_E} + \(\sum_{E\in \mcal E_p^+} \abs{\rho_E} + h_p \norm{f}_{0,\omega_p}\)\norm{\nabla e}_{0,\omega_p}
\end{align}
mit $\mcal E_p^0 = \mcal E_p \setminus \mcal E_p^+ = \{E \in \mcal E_p \mid \rho_E < -d_E\}$. Auch hier betrachten wir die Ungleichung \eqref{eq:4.53}, wobei wir dieses Mal $w = e\phi_p$ setzen, d.h. mit der obigen Wahl $c = 0$ setzen. In diesem Fall kann kein anderes $c$ gewählt werden, da wir wegen $p \not\in \Omega$ nicht direkt $\rho_p (c) = 0$ aus \eqref{eq:4.22b} folgern können. Da $p \in \partial \Omega$ ist, gilt mindestens auf einer Kante $E \in \mcal E_p$ von $\partial \omega_p$
\[
	e = u- u_{\mcal S} = 0 \, .
\]
Damit ist $e$ auf einer Teilmenge, vom Maße ungleich Null, des Randes gleich Null und wir können daher die allgemeine \idx{Poincaré-Friedrich-Ungleichung} \eqref{eq:4.41} anwenden. Damit erhalten wir die Anteile von $E \in \mcal E_p^+$ durch die Abschätzungen \eqref{eq:4.49}, \eqref{eq:4.50} und \eqref{eq:4.51}. Um die Anteile für die Kanten $E \in \mcal E^0_p$ zu erhalten, betrachten wir
\begin{align*}
\begin{aligned}
	u_{\mcal S} + w &= u_{\mcal S} + e \phi_p = u_{\mcal S} + (u-u_{\mcal S}) \phi_p \\
	& = \underbrace{(1-\phi_p)}_{\in [0,1]} u_{\mcal S} + \underbrace{\phi_p}_{\in [0,1]} u \\
	& \ge (1-\phi_p) \psi + \phi_p \psi = \psi \, .
\end{aligned}
\end{align*}
Da die Ungleichung punktweise gilt, folgt auch
\begin{align*}
	\int_E w \, ds \ge \int_E \psi-u_{\mcal S} \, ds \stackrel{\scriptsize \eqref{eq:my4.41}}\lra \alpha_E(w) \gtrsim \psi(x_E) - u_{\mcal S}(x_E) \stackrel{\scriptsize \eqref{eq:4.11}}= -d_E \,\norm{\phi_E}^{-1} 
\end{align*}
und daher gilt $\alpha_E(w) \lesssim d_E \, \norm{\phi_E}^{-1}$. Alle Aussagen ersetzt in \eqref{eq:4.53} ergeben dann die Behauptung.

\textit{Fall 4}: Sei $p \in \mcal N^0\setminus(\mcal N^{0-}\cup \mcal N^{0+})$. Wir behaupten, dass
\begin{align}\label{eq:4.56}
	\rho_p (e) \lesssim \sum_{E\in \mcal E^0_p} d_E \, \abs{\rho_E} + \(\sum_{E\in \mcal E_p^+} \abs{\rho_E} + h_p \norm{f}_{0,\omega_p}\)\norm{\nabla e}_{0,\omega_p}
\end{align}
gilt. Um dies zu zeigen, spalten wir den Fehler $e = e^+ + e^-$ auf mit $e^+ \coloneqq \max\{e,0\}$ und $e^-\coloneqq \min\{e,0\}$. Damit lässt sich der lokale Anteil des Indikators $\rho_{\mcal S}$ schreiben als
\begin{align}\label{eq:4.57}
	\rho_p(e) = \rho_p (e^+ + e^-) = \rho_p(e^+)+\rho_p(e^-) \, .
\end{align}
Wir betrachten zunächst $\rho_p(e^+)$ und setzen analog zum Fall 2
\begin{align}\label{eq:4.58}
	w = (e^+-c) \phi_p \, , \quad c =\min\left\{ \(\int_E e^+\phi_p \, ds \)\(\int_E \phi_p\, ds\)^{-1} \mid E \in \mcal E_p \right\} \, .
\end{align}
Da $e^+ \ge 0 $ ist, gilt auch $c \ge 0$. Wegen $ \mcal N^0\setminus(\mcal N^{0-}\cup \mcal N^{0+}) \subset \mcal N \cap \Omega$ gilt nach \eqref{eq:4.22a} $\rho_p(1)\le 0$, also analog zu Fall 2
\begin{align}\label{eq:4.59}
\begin{aligned}
	\rho_p(e^+) & \le \rho_p(e^+) -\underbrace{c \, \rho_p(1)}_{\le 0} = \rho_p(e^+-c) \\
	& \le \sum_{E\in \mcal E_p} \alpha_E(w) \rho_E \norm{\phi_E} + \norm f_{0,\omega_p} \norm{w-\pi_p w}_{0,\omega_p} \, .
\end{aligned}
\end{align}
Die Aussagen \eqref{eq:4.58}, \eqref{eq:4.59} sind identisch zu denen aus Fall 2, wenn wir $e = e^+$ setzen. Damit folgt mit $\norm{\nabla e^+}_{0,\omega_p} \le \norm{\nabla e}_{0,\omega_p}$ und denselben Argumenten wie in Fall 2, dass
\begin{align}\label{eq:4.60}
	\rho_p (e^+) \lesssim \(\sum_{E\in \mcal E^+_p} \abs{\rho_E} + h_p \norm f_{0,\omega_p} \) \norm{\nabla e}_{0,\omega_p} \, .
\end{align}
Wir betrachten nun $\rho_p(e^-)$. Analog zu Fall 3 setzen wir $w = (e^- -c)\phi_p, c = 0$ und leiten damit wieder die obere Schranke
\begin{align}\label{eq:4.61}
	\rho_p (e^-) \le \sum_{E\in \mcal E_p} \alpha_E(w) \rho_E \norm{\phi_E} + \norm f_{0,\omega_p} \norm{w-\pi_p}_{0,\omega_p} 
\end{align}
her. Weiter gilt punktweise
\begin{align*}
	w &= e^-\phi_p \ge e^- = \min\{e,0\} =\min\{u-u_{\mcal S},0\} \\
	& \ge \min\{\underbrace{\psi-u_{\mcal S}}_{\le 0},0\} = \psi - u_{\mcal S}
\end{align*}
und damit auch die Aussage über $E \in \mcal E_p$ integriert; also folgt aus \eqref{eq:my4.41}
\begin{align}\label{eq:4.62}
	0 \ge \alpha_E(w) \gtrsim \psi(x_E) - u_{\mcal S}(x_E) = -d_E \, \norm{\phi_E}^{-1} \quad \forall \, E \in \mcal E_p \, .
\end{align}
Damit folgt speziell für alle $E\in\mcal E^0_p$ die Abschätzung
\begin{align}\label{eq:4.63}
\begin{aligned}
	\abs{\alpha_E(w) \rho_E \,\norm{\phi_E}} &= \abs{\alpha_E(w)} \, \abs{\rho_E} \, \norm{\phi_E} \\
	&\!\!\! \stackrel{\scriptsize \eqref{eq:4.62}}\lesssim d_E \, \norm{\phi_E}^{-1} \,\abs{\rho_E} \,\norm{\phi_E}  = d_E \, \abs{\rho_E} \, .
\end{aligned}
\end{align}
Nun bleiben noch die oberen Schranken von $\abs{\alpha_E(w)}$ für $E \in \mcal E^+_p$ und $\norm{w-\pi_p w}_{0,\omega_p}$ zu zeigen. Da $p \not\in \mcal N^{0+}$, also kein isolierter Knoten ist, gibt es mindestens eine Kante $E\in\mcal E_p$, so dass $u_{\mcal S} = \psi$ gilt. Damit folgt
\[
	0 = \psi-u_{\mcal S} \le e^- = \min\{e,0\} \le 0 \, \lra \, e^- = 0 \text{ auf } E\, .
\]
Wie in Fall 3 ist damit die allgemeine \idx{Poincaré-Friedrich-Ungleichung} anwendbar und wir können die Aussagen \eqref{eq:4.49}, \eqref{eq:4.50} und \eqref{eq:4.51} mit Anwendung von $\norm{\nabla e^-}_{0,\omega_p} \le \norm{\nabla e}_{0,\omega_p}$ zeigen. Insgesamt folgt dann mit \eqref{eq:4.63}
\begin{align}\label{eq:4.64}
	\rho_p(e^-) \lesssim \sum_{E\in \mcal E^0_p} d_E \, \abs{\rho_E} + \(\sum_{E\in \mcal E^+_p} \abs{\rho_E} + h_p \norm f_{0,\omega_p} \) \norm{\nabla e}_{0,\omega_p} \, .
\end{align}
Zusammen mit \eqref{eq:4.57}, \eqref{eq:4.60} und \eqref{eq:4.64} folgt dann die Behauptung \eqref{eq:4.56}.


\textit{Fall 5}: Es sei nun $p \in \mcal N^{0+}$.  Wir behaupten, dass 
\begin{align}\label{eq:4.65}
\begin{aligned}
	\rho_p (e) \lesssim &  \sum_{E\in \mcal E^0_p} d_E \, \abs{\rho_E}\\
	& + \(\sum_{E\in \mcal E_p^+} \abs{\rho_E} + h_p \norm{f}_{0,\omega_p}\)(\norm{\nabla e}_{0,\omega_p}+\norm{\nabla (\psi-u_{\mcal S})}_{0,\omega_p})
\end{aligned}
\end{align}
gilt. Wie in Fall 4 verwenden wir die Aufteilung des Indikators nach Gleichung \eqref{eq:4.57}. Mit genau demselben Vorgehen wie in Fall 4 können wir für $\rho_p (e^+)$ zeigen, dass die Abschätzung \eqref{eq:4.60} gilt. Für $\rho_p(e^-)$ können die Aussagen \eqref{eq:4.61} bis \eqref{eq:4.63} wie in Fall 4 gezeigt werden. Es bleiben also auch hier noch die oberen Schranken von $\abs{\alpha_E(w)}$ für $E\in \mcal E^+_p$ und $\norm{w-\pi_p w}_{0,\omega_p}$ zu zeigen.

Wir erinnern uns, dass $\psi-u_{\mcal S} \le e^- \le w \le 0$ gilt und damit folgt
\begin{align}\label{eq:4.66}
\begin{aligned}
	0&\ge \alpha_E(w) = \(\int_E w \, ds \) \(\int_E \phi_E \, ds\)^{-1} \\
	& \ge  \(\int_E \psi-u_{\mcal S} \, ds \) \(\int_E \phi_E \, ds\)^{-1} \\
	& = \alpha_E(\psi-u_{\mcal S})\, .
\end{aligned}
\end{align}
Aus \eqref{eq:4.66} folgt 
\begin{align}\notag
	\abs{\alpha_E(w)} \, \norm{\phi_E} & \le \abs{\alpha_E(\psi-u_{\mcal S})} \, \norm{\phi_E} \\
	\notag
	& = \bigg|\(\int_E \psi-u_{\mcal S} \, ds\)\underbrace{\(\int_E \phi_E\, ds\)^{-1}}_{\lesssim h_p^{-1}}\bigg| \cdot \underbrace{\(\int_{\omega_p} \nabla\phi_E \nabla\phi_E \, dx\)^{\frac 12}}_{\lesssim h_p^{\frac 12}} \\
	\notag
	& \lesssim h_p^{-\frac 12} \Abs{\int_E \psi-u_{\mcal S} \, ds} \stackrel{\scriptsize \text{C.S.}}\lesssim h_p^{-\frac 1 2} \norm{\psi-u_{\mcal S}}_{0,E} \\
	\label{eq:4.67}
	& \lesssim \norm{\nabla (\psi-u_{\mcal S})}_{0,\omega_p} \, ,
\end{align}
wobei im letzten Schritt eine \textit{skalierte} Version der \index{Poincaré-Friedrich-Ungleichung}Poincaré-Friedrich-Unglei-chung
\footnote{Anschaulich können wir uns dies folgendermaßen vorstellen: Da $\psi-u_{\mcal S}$ linear und am Punkt $p$ gleich ist, ist der Gradient $\nabla (\psi-u_{\mcal S})=\text{const.}$ Damit kann man mit dieser Konstanten als Höhe mit dem Mittelwertsatz der Integralrechnung die beiden Normen gegenseitig abschätzen, wobei diese Ungleichung abhängig von einer Konstanten $c$ ist, die wiederum nur von der Form von $\omega_p$ bzw. $E$ abhängt.}
 verwendet wurde, die darauf basiert, dass $(\psi-u_{\mcal S})(p) = 0$ und $\psi-u_{\mcal S}$ linear ist wegen Voraussetzung \ref{vor:4.1}. Wegen $\psi-u_{\mcal S} \le w$ folgt auch, dass
\begin{align}\label{eq:4.68}
	\norm w_{0,\omega_p} \le \norm{\psi-u_{\mcal S}}_{0,\omega_p} \lesssim h_p \norm{\nabla (\psi-u_{\mcal S})}_{0,\omega_p} \, ,
\end{align}
wobei in \eqref{eq:4.68} im letzten Schritt wegen $(\psi-u_{\mcal S})(p) = 0$ wieder die skalierte Version der \idx{Poincaré-Friedrich-Ungleichung} verwendet wurde. Aus \eqref{eq:4.67} folgern wir unter Verwendung der Dreiecksungleichung
\begin{align}\label{eq:4.69}
\begin{aligned}
	\norm{\pi_p w}_{0,\omega_p} & \le \sum_{E\in \mcal E_p} \abs{\alpha_E(w)} \, \norm{\phi_E}_{0,\omega_p} \\ 
	& \lesssim \sum_{E\in \mcal E_p} \abs{\alpha_E (w)}\, h_p \underbrace{\norm{\nabla \phi_E}_{0,\omega_p}}_{=\norm{\phi_E}} \\
	& \lesssim h_p \norm{\nabla(\psi-u_{\mcal S})}_{0,\omega_p} \, .
\end{aligned}
\end{align}
Also folgt aus \eqref{eq:4.68} und \eqref{eq:4.69} insgesamt
\begin{align}\label{eq:4.70}
	\norm{w-\pi_p w}_{0,\omega_p} \le \norm w_{0,\omega_p} + \norm{\pi_p w }_{0,\omega_p} \lesssim h_p \norm{\nabla(\psi-u_{\mcal S})}_{0,\omega_p} \, .
\end{align}
Setzen wir nun für die Kanten $E\in \mcal E^0_p$ die Abschätzung \eqref{eq:4.63} und für die Kanten $E\in \mcal E^+_p$ die Ungleichungen \eqref{eq:4.67} und \eqref{eq:4.70} in die Bedingung \eqref{eq:4.61} ein, so erhalten wir die Aussage
\begin{align}\label{eq:4.71}
	\rho_p(e^-) \lesssim \sum_{E\in \mcal E^0_p} d_E \, \abs{\rho_E} + \(\sum_{E\in \mcal E^+_p} \abs{\rho_E}  + h_p \norm f_{0,\omega_p} \) \norm{\nabla(\psi-u_{\mcal S})}_{0,\omega_p} \, .
\end{align}
Damit folgt  mit der Aufteilung \eqref{eq:4.57} und den Abschätzungen \eqref{eq:4.60} und \eqref{eq:4.71} die Behauptung.


\textit{Fall 6}: Es sei $p \in \mcal N^{0-}$. In diesem Fall haben wir vollen Kontakt, also $u_{\mcal S} = \psi$ auf $\omega_p$ und daher gilt
\[
	e = u-u_{\mcal S} = u-\psi \ge 0 \text{ auf ganz } \omega_p \, .
\]
Weiter gelten für alle $p \in \mcal N^{0-}$  die Eigenschaften $f\le 0$ auf $\omega_p$ und $j_E \le 0$ für alle $E \in \mcal E_p$. Daher rechnen wir leicht nach, dass gilt:
\begin{align}
	\rho_p(e) = \rho_{\mcal S} (e \phi_p)= \int_{\omega_p}\underbrace{ f e \phi_p}_{\le 0} \, dx + \sum_{E\in \mcal E_p} \int_E \underbrace{j_E e \phi_p}_{\le 0} \, ds \le 0 \, .
\end{align}


Bevor wir die sechs Fälle zusammenführen, machen wir uns klar, dass 
\begin{align*}
	 & (\mcal N^+\setminus \mcal N^{++})  \cup (\mcal N\cap \partial \Omega)  \cup \overbrace{(\mcal N^0 \setminus (\mcal N^{0-} \cup \mcal N^{0+}))  \cup\mcal N^{0+}}^{=\mcal N^0\setminus \mcal N^{0-}} \\
	 = \, & (\mcal N\cap \Omega) \setminus (\mcal N^{0-}\cup \mcal N^{++})\cup (\mcal N \cap \partial \Omega) = \mcal N \setminus (\mcal N^{0-} \cup \mcal N^{++}) 
\end{align*}
gilt. Verwenden wir nun die sechs gezeigten Fälle, so ergibt sich:
\begin{align*}
	\rho_{\mcal S}(e) = & \sum_{p \in \mcal N} \rho_p(e) \\
	= & \sum_{E\in \mcal E^0} d_E\, \abs{\rho_E} 
		+ \sum_{p \in \mcal N \setminus \mcal N^{0-}} \Bigg( \sum_{E \in \mcal E_p^+} \abs{\rho_E} \Bigg) \norm{\nabla e}_{0,\omega_p} \\
	 & + \! \! \!\! \sum_{p \in \mcal N\setminus(\mcal N^{0-}\cup\mcal N^{++})}\!\!\! h_p \norm{f}_{0,\omega_p} \norm{\nabla e}_{0,\omega_p} + \sum_{p \in \mcal N^{++}} h_p \norm{f-\bar f_p}_{0,\omega_p} \norm{\nabla e}_{0,\omega_p} \\
	 & + \sum_{p \in \mcal N^{0+}} \Bigg(\sum_{E\in \mcal E^+_p} \abs{\rho_E} + h_p \norm f_{0,\omega_p}\Bigg) \norm{\nabla(\psi-u_{\mcal S})}_{0,\omega_p}  \, .
\end{align*}
Damit folgt nach der Cauchy-Schwarz-Ungleichung, dass mit einer Konstante $C>0$, die nur von der Quasi-Uniformität von $\mcal T_h$ abhängt, gilt:
\begin{align*}
	C \rho_{\mcal S}(e) & \le  \sum_{E\in \mcal E^0} d_E\, \abs{\rho_E} + \Bigg(\sum_{E\in \mcal E^+} \abs{\rho_E}^2 + \sum_{p \in \mcal N\setminus(\mcal N^{0-}\cup\mcal N^{++})} h_p^2 \norm{f}^2_{0,\omega_p}  \\
	&\ \,  +  \sum_{p \in \mcal N^{++}} h_p^2 \norm{f-\bar f_p}_{0,\omega_p}^2\Bigg)^{\frac 12} \Bigg( \norm{\nabla e}^2_{0,\Omega} + \sum_{p \in \mcal N^{0+}} \norm{\nabla(\psi-u_{\mcal S})}_{0,\omega_p}^2 \Bigg)^{\frac 1 2} \\
	& =   \sum_{E\in \mcal E^0} d_E\, \abs{\rho_E} \\
	&\ \, + \Bigg(\sum_{E\in \mcal E^+} \abs{\rho_E}^2  + \osc_2(u_{\mcal S},\psi,f)^2\Bigg)^{\frac 12} \Big( \norm{\nabla e}^2_{0,\Omega} + \osc_1(u_{\mcal S},\psi)^2 \Big)^{\frac 1 2} \\
	& \le\sum_{E\in \mcal E^0} d_E\, \abs{\rho_E}  \\
	&\ \,  + \frac \eps2 \Bigg(  \sum_{E\in \mcal E^+} \abs{\rho_E}^2 + \osc_2(u_{\mcal S},\psi,f)^2\Bigg) + \frac 1{2\eps} \Big( \norm{\nabla e}^2_{0,\Omega} + \osc_1(u_{\mcal S},\psi)^2 \Big)  ,
\end{align*}
wobei wir als letztes die Ungleichung von Young mit einem $\eps > 0$ verwendet haben und
\[
	\mcal E^0 = \bigcup_{p \in \mcal N}\mcal E^0_p \, , \quad \mcal E^+ = \bigcup_{p \in \mcal N} \mcal E_p^+ \, .
\] 
Wählen wir $\eps \le C$, so ergibt sich nach leichtem Umstellen der Ungleichung
\begin{align*}
	\!\!\!\!\!\!\!\!\!  c(\eps) \rho_{\mcal S}(e) & \le \frac \eps2 \(\sum_{E\in \mcal E^+} \abs{\rho_E}^2+\osc_2(u_{\mcal S},\psi,f)^2\) \\
	& \ \ \  + \frac 1{2\eps} \osc_1(u_{\mcal S},f)^2 + \sum_{E\in \mcal E^0} d_E \, \abs{\rho_E} \\
\end{align*}
\begin{align*}
	\qquad \qquad \qquad & \le \(1+\frac 1{2\eps}\) \sum_{E\in \mcal E_p} \eta_E \, \abs{\rho_E} \\
	& \ \ \ + \(\frac\eps 2 + \frac 1{2\eps}\) \(\osc_2(u_{\mcal S},\psi,f)^2+\osc_1(u_{\mcal S},f)^2\) \\
	& \lesssim \sum_{E\in \mcal E_p} \eta_E \, \abs{\rho_E} + \osc(u_{\mcal S},\psi,f)^2 
\end{align*}
mit $c(\eps) = \eps-\frac 1{2\eps}$ und $\eta_E$ wie in \eqref{eq:4.11} definiert. Damit folgt die Behauptung.
\end{proof}


Mit dem Lemma \ref{lem:4.21} und der Äquivalenz des a posteriori Fehlerschätzers $-\mcal I_{\mcal Q}(\eps_{\mcal V})$ zum Fehlerindikator $\rho_{\mcal S}(\eps_{\mcal V})$ folgt das gewünschte Resultat für unseren Fehlerschätzer im nächsten Theorem.


\begin{theorem}\label{theorem:4.22}
Es sei Voraussetzung \ref{vor:4.1} für $\psi$ erfüllt. Dann ist der hierarchische Fehlerschätzer $-\mcal I_{\mcal Q}(\eps_{\mcal V})$ eine obere Schranke für den Fehler im Energiefunktional bis auf Addition von Oszillationstermen und einer Konstante $C$, die nur von der Quasi-Uniformität von $\mcal T_h$ abhängt, d.h.
\begin{align}\label{eq:4.72}
	J(u_{\mcal S}) - J(u) \lesssim -\mcal I_{\mcal Q}(\eps_{\mcal V}) + \osc (u_{\mcal S},\psi,f)^2 \, .
\end{align}
\end{theorem}

\begin{proof}
Die Aussage folgt direkt durch Lemma \ref{lem:4.12} und \ref{lem:4.21}, denn
\begin{align*}
	J(u_{\mcal S})-J(u) & = - \mcal I (e) \le \rho_{\mcal S}(e) \\
	& \lesssim \underbrace{\sum_{E\in \mcal E}\eta_E \, \abs{\rho_E}}_{=\rho_{\mcal S}(\eps_{\mcal V})} + \osc (u_{\mcal S},\psi,f)^2 \\
	& \le 2\cdot (-\mcal I_{\mcal Q}(\eps_{\mcal V}))+ \osc (u_{\mcal S},\psi,f)^2 \\
	& \le 2 \cdot (-\mcal I_{\mcal Q}(\eps_{\mcal V})+ \osc (u_{\mcal S},\psi,f)^2)
\end{align*}
und damit folgt die Behauptung.
\end{proof}


An der Abschätzung \eqref{eq:4.72} können wir sehen, dass es sinnvoll ist, nicht nur den hierarchischen Fehlerschätzer $-\mcal I_{\mcal Q}(\eps_{\mcal V})$ von einem Verfeinerungsschritt zum nächsten zu verringern, sondern auch zu fordern, dass  die \idx{Oszillationsterme} $\osc (u_{\mcal S},\psi,f)$ kleiner werden. Daher wollen wir in unserem Algorithmus später für einen adaptiven Verfeinerungsschritt diese Forderung mit verwenden, dass die \idx{Oszillationsterme} aus \eqref{eq:4.24} verringert werden.



Wie wir in Bemerkung \ref{bem:4.2} gesehen haben, gibt eine obere Schranke vom Fehler der Funktionswerte des Energiefunktionals $J$ auch eine obere Schranke für den exakten Fehler bzgl. der Energienorm an.

\begin{theorem}\label{theorem:4.23}
Es sei die Voraussetzung \ref{vor:4.1} für $\psi$ erfüllt. Dann liefert die Lösung vom lokalisierten Defektproblem \eqref{eq:4.9} eine obere Schranke für den exakten Fehler
\begin{align}\label{eq:4.74}
	\norm{u-u_S} \lesssim \(\sum_{E\in \mcal E} \eta_E \,\abs{\rho_E} \)^{\frac 12} + \osc (u_{\mcal S},\psi,f) 
\end{align}
bis auf Oszillationsterme, wie in \eqref{eq:4.24} definiert, und einer Konstante, die nur von der Quasi-Uniformität von $\mcal T_h$ abhängt.
\end{theorem}

\begin{proof}
Mit Lemma \ref{lem:4.12} und \ref{lem:4.21} folgt direkt
\begin{align*}
	\norm{u-u_{\mcal S}}^2 \le 2 \rho_{\mcal S} (e) \lesssim \sum_{E\in \mcal E} \eta_E \, \abs{\rho_E} + \osc (u_{\mcal S},\psi,f)^2 \, .
\end{align*}
Nach Wurzel ziehen und Verwendung der Dreiecksungleichung folgt die Behauptung.
\end{proof}


Wir wollen noch ein Resultat liefern, was die Forderung an die Verringerung der \idx{Oszillationsterme} in jedem Verfeinerungsschritt begründet. Hierbei handelt es sich um ein analoges Resultat zu Lemma 3.8 aus \cite{MorNoc}.

\begin{lemma}\label{lem:4.24}
Es sei $0 < \gamma < 1$ ein Parameter, der die Reduktion der Größe des Dreiecks bei Verfeinerung wiedergibt. Weiter sei $0 < \hat \theta < 1$ gegeben und eine Menge an Punkten $\hat{\mcal N}\subset \mcal N$, die die zu verfeinernden Dreiecke anzeigen, gegeben, so dass
\[
	\osc(u_{\mcal S},\psi,f,\hat{\mcal N}) \ge \hat\theta \osc (u_{\mcal S},\psi,f,\mcal N) \, .
\]
Dann existiert ein $\hat\alpha \in (0,1)$, so dass
\begin{align}\label{eq:my4.70}
	\osc(u_{\mcal S},\psi,f,\tilde{\mcal N}) \le \hat \alpha \osc (u_{\mcal S},\psi,f,\mcal N) \, ,
\end{align}
wobei $\tilde{\mcal N}$ die Menge an Punkten nach Verfeinerung der Triangulierung $\mcal T_h$ bzgl. der Punkte $\hat{\mcal N}$ ist.
\end{lemma}

\begin{proof}
Es sei $T \in \mcal T_h$ ein Element, das Teilmenge von einem $\omega_p$ ist. Da
\[
	\bar f_p = \frac 1{\abs{\omega_p}} \int_{\omega_p} f \, dx \text{ bzw. } \bar f_T \coloneqq \frac 1{\abs T} \int_T f \, dx
\]
$L^2$-Projektionen von $f$ auf den Raum der stückweise konstanten Funktionen über $\omega_p$ bzw. $T$ sind, gilt
\[
	\norm{f-\bar f_p}_{0,\omega_p} \le \norm{f-\bar f_T}_{0,T} \, .
\]
Weiter können wir auch mit einem Kontraktionsparameter $\beta > 0$ zeigen, dass gilt:
\[
	\norm{f-\bar f_p}_{0,\omega_p} \ge \beta\, \norm{f-\bar f_T}_{0,T} \, .
\]
Analoge Aussagen ergeben sich für $\norm{f}_{0,\omega_p}$ und $\norm f_{0,T}$. Damit lässt sich der Oszillationsterm $\osc_2 (u_{\mcal S},\psi,f)$ äquivalent beschreiben durch
\[
	\widetilde\osc_2 (u_{\mcal S},\psi,f,\mcal T_h) = \(\sum_{T \in \mcal T_h^1} h_T^2 \, \norm{f-\bar f_T}_{0,T}^2 + \sum_{T \in \mcal T_h^2} h_T^2\, \norm f_{0,T}^2\)^{\frac 12},
\]
wobei $\mcal T_h^i, i = 1,2$ die Menge der Dreiecke ist, über die die Summanden des Oszillationsterms berechnet werden sollen, und $h_T$ wie gewohnt der Radius des Dreiecks ist. 

Es sei nun $\hat{\mcal T_H^i}, i = 1,2$ die zu verfeinernde Menge an gröberen Elementen. Da $h_T \le \gamma h_{\hat T}$, ergibt sich
\begin{align*}
	\widetilde \osc_2 (u_{\mcal S},\psi,f,\mcal T_h)^2 &=  \sum_{T \in \mcal T_h^1} h_T^2 \, \norm{f-\bar f_T}_{0,T}^2 + \sum_{T \in \mcal T_h^2} h_T^2\, \norm f_{0,T}^2 \\
	&\le  \gamma^2 \(\sum_{\hat T \in \hat{\mcal  T}_H^1} h_{\hat T}^2 \, \norm{f-\bar f_{\hat T}}_{0,\hat T}^2 + \sum_{\hat T \in \hat{\mcal T}_H^2} h_{\hat T}^2\, \norm f_{0,\hat T}^2\) \\
	& \ \ \, +  \(\sum_{ T \in \mcal T_H \setminus \hat{\mcal  T}_H^1} h_{ T}^2 \, \norm{f-\bar f_{ T}}_{0, T}^2 + \sum_{ T \in \mcal T_H\setminus \hat{\mcal T}_H^2} h_{ T}^2\, \norm f_{0, T}^2\) \\
	& \!\! \! \stackrel{\scriptsize\text{"`}+0\text{"'}}= \underbrace{ (\gamma^2-1)}_{\le 0} \, \underbrace{\widetilde{\osc}_2(u_{\mcal S},\psi,f,\hat{\mcal T}_H)^2}_{\ge 0}  + \widetilde \osc_2(u_{\mcal S},\psi,f,\mcal T_H)^2 \\
	& \le \tilde \alpha \, \widetilde \osc_2(u_{\mcal S},\psi,f,\mcal T_H)^2 \, .
\end{align*}
Eine analoge Aussage ergibt sich auch für $\widetilde\osc_1(u_{\mcal S},\psi,\mcal T_h)$. Wegen der Äquiva-lenz der Darstellung von $\widetilde\osc_1, \widetilde\osc_2$ zu den Oszillationstermen \eqref{eq:4.24}, folgt die Behauptung \eqref{eq:my4.70}.
\end{proof}









\subsection{Effektivität des Fehlerschätzers}
\label{kap:4.1.5}

Der Fehlerschätzer  $-\mcal I_{\mcal Q}(\eps_{\mcal V})$ ist für den exakten Fehler des Energiefunktionals auch effektiv, d.h. wir werden zeigen, dass der hierarchische Fehlerschätzer $-\mcal I_{\mcal Q}(\eps_{\mcal V})$ auch eine untere Schranke für $-\mcal I(e) = J(u_{\mcal S}) - J(u)$ ist.


\begin{theorem}\label{theorem:4.25}
Das Hindernis $\psi$ sei stückweise linear und stetig. Dann ist der hierarchische a posteriori Fehlerschätzer $\mcal I_{\mcal Q}(\eps_{\mcal V})$ auch eine untere Schranke für den Fehler im Energiefunktional im Sinne von
\begin{align}
	-\mcal I_{\mcal Q}(\eps_{\mcal V}) \le 6 (J(u_{\mcal S})-J(u)) \, .
\end{align}
\end{theorem}

\begin{proof}
Zunächst folgt mit \eqref{eq:4.16}
\begin{align}\notag
	-\mcal I_{\mcal Q} (\eps_{\mcal V}) & \le \rho_{\mcal S} (\eps_{\mcal V}) = \rho_{\mcal S} \(\sum_{E\in \mcal E} \eps_{\mcal V}(x_E) \phi_E\) \\
	\notag
	& = \sum_{E\in \mcal E} \eps_{\mcal V} (x_E) \rho_{\mcal S}(\phi_E) \\
	& = \sum_{E \in \mcal E} \eta_E \, \abs {\rho_E}  \label{eq:my4.32}
\end{align}
mit $\eta_E = \abs{\eps_{\mcal V}(x_E)} \cdot \norm{\phi_E}$ und $\rho_E = \frac {\rho_{\mcal S}(\phi_E)}{\norm{\phi_E}}$, wobei man zeigen kann, dass $\sign (\eps_{\mcal V}(x_E)) = \sign (\rho_{\mcal S} (\phi_E))$ gilt. Weiter sollte man erwähnen, dass \eqref{eq:my4.32} äquivalent ist zu \cite{SiebVee} Gleichung (2.16).

Das weitere Vorgehen ist ähnlich zum Beweis von Theorem 3.2 aus \cite{SiebVee}. Es sei
\[
	\varphi = \frac 13 \sum_{E\in \mcal E} \beta_E \phi_E
\]
eine Linearkombination aus Bubble-Funktionen. Dann lässt sich $u_{\mcal S} + \varphi$ auf jedem $T \in \mcal T_h$ durch eine Konvexkombination aus $v_E \coloneqq u_{\mcal S} + \beta_E \phi_E, E \in \mcal E$ schreiben, d.h.
\[
	(u_{\mcal S} + \varphi)\Big|_{T} = \frac 13 \sum_{E\in\mcal E, E \subset T} v_E \Big|_T \, .
\]
Da $\R^2 \ni x \mapsto \frac 12 \abs x^2$ konvex ist, rechnen wir mit den obigen Bezeichnungen schnell nach, dass gilt
\begin{align*}
	J(u_{\mcal S} + \varphi) & = \int_\Omega \frac 12 \abs{\nabla(u_{\mcal S}+\varphi)}^2 - f (u_{\mcal S} + \varphi )\, dx \\
	& = \sum_{T\in \mcal T_h} \int_T \frac 12 \Abs{\nabla(u_{\mcal S}+\varphi)\Big|_{T}}^2 - f (u_{\mcal S} + \varphi )\Big|_T\, dx \\
	& =  \sum_{T\in \mcal T_h} \int_T \frac 12 \Abs{\(\frac 13 \sum_{E\in\mcal E, E \subset T}\nabla v_E \Big|_T\)}^2 - f\( \frac 13 \sum_{E\in\mcal E, E \subset T} v_E \Big|_T\)\, dx \\
	& \le \frac 13 \sum_{E\in\mcal E, E \subset T} \, \sum_{T\in \mcal T_h} \int_T \frac 12 \Abs{\nabla v_E \Big|_T}^2 - f v_E \Big|_T\, dx \, .
\end{align*}
Da wir drei Kanten pro Dreieck $T$ haben, gilt analog die Gleichung
\[
	J(u_{\mcal S}) = \frac 13 \sum_{E\in\mcal E , E \subset T}\,  \sum_{T\in \mcal T_h} \int_T \frac 12 \Abs{\nabla u_{\mcal S}}^2 - f u_{\mcal S}\, dx  \, .
\]
Durch Subtraktion der letzten beiden Terme und einigen Umformungen ergibt sich dann
\begin{align}
	J(u_{\mcal S}) - J(u_{\mcal S}+\varphi) \ge \frac 13 \sum_{E\in \mcal E} (J(u_{\mcal S})-J(u_{\mcal S} + \beta_E \phi_E)) \, .
\end{align}
Wir rechnen nach, dass für alle $E\in \mcal E$
\begin{align*}
	J(u_{\mcal S} + \beta_E \phi_E) & = \frac 12 a(u_{\mcal S}+\beta_E \phi_E, u_{\mcal S} + \beta_E \phi_E) - (f, u_{\mcal S} + \beta_E \phi_E) \\
	& = J(u_{\mcal S}) + \frac 12 a(\beta_E\phi_E,\beta_E\phi_E)-((f,\beta_E\phi_E)-a(u_{\mcal S},\beta_E\phi_E)) \\
	& = J(u_{\mcal S}) + \mcal I (\beta_E\phi_E) 
\end{align*}
gilt. Damit ist das Minimieren von $J(u_{\mcal S}+\beta_E\phi_E)$, so dass $\beta_E \ge -d_E$, mit $d_E$ wie oben definiert, äquivalent ist zum Problem:
\[
	\min_{\beta_E \ge -d_E} \mcal I (\beta_E\phi_E) \, ,
\]
was den nächsten Schritt legitimiert. Wir setzen nun $\beta_E = \eps_{\mcal V}(x_E)$, dann gilt, dass $u_{\mcal S} + \beta_E \phi_E \in  K$ ist für alle $E \in \mcal E$ und damit aufgrund der Konvexität von $K$ auch $u_{\mcal S}+\varphi \in \mcal K$. Damit folgt insgesamt
\begin{align*}
	J(u_{\mcal S}) -J(u) & \ge J(u_{\mcal S})-J(u_{\mcal S}+\varphi) \\
	& \ge  \frac 13 \sum_{E\in \mcal E} (J(u_{\mcal S})-J(u_{\mcal S} + \beta_E \phi_E))=  \frac 13 \sum_{E\in \mcal E} -\mcal I (\beta_E \phi_E) \\
	&  =   \frac 13 \sum_{E\in \mcal E} \(\rho_{\mcal S}(\beta_E \phi_E) - \frac 12 a(\beta_E\phi_E,\beta_E\phi_E)\) \\
	& =   \frac 13 \sum_{E\in \mcal E} \(\beta_E \, \rho_{\mcal S}(\phi_E) - \frac 12 \beta_E^2 a(\phi_E,\phi_E)\) \\
	& \ge   \frac 13 \sum_{E\in \mcal E}\(\frac{\max\{-d_E,\rho_E\}}{\norm{\phi_E}} \, \rho_{\mcal S}(\phi_E) - \frac 1 2 \frac{\max\{-d_E,\rho_E\}^2}{\norm{\phi_E}^2} \norm{\phi_E}^2 \) \\
	& = \frac 13 \sum_{E\in \mcal E} \bigg( \underbrace{\max\{-d_E,\rho_E\} \rho_E}_{=\eta_E \, \abs{\rho_E}} - \frac 12 \underbrace{\max\{-d_E,\rho_E\}^2}_{\ge \eta_E \, \abs{\rho_E}} \bigg) \\
	& \ge \frac 13 \sum_{E\in \mcal E} \frac 12 \eta_E \, \abs{\rho_E} = \frac 16 \sum_{E\in \mcal E} \eta_E \, \abs{\rho_E} \, .
\end{align*}
Zusammen mit \eqref{eq:my4.32} folgt dann die Behauptung.
\end{proof}







\section{Ein adaptiver Algorithmus}
\label{kap:4.2}

Mit den Resultaten aus Kapitel \ref{kap:4.1} können wir nun einen implementierbaren Algorithmus für eine adaptive Verfeinerung angeben. 

Mittels Theorem \ref{theorem:4.22} bildet der hierarchische a posteriori Fehlerschätzer $-\mcal I_{\mcal Q}(\eps_{\mcal V})$ eine obere Schranke für den exakten Fehler $J(u_{\mcal S})-J(u)$ (und wegen Theorem \ref{theorem:4.25} auch eine untere), d.h. dass die Verringerung unseres Schätzers auch eine Verkleinerung des Fehlers mit sich führt. Aufgrund von Korollar \ref{kor:4.13} ist außerdem der Fehlerschätzer $-\mcal I_{\mcal Q}(\eps_{\mcal V})$ äquivalent zum Fehlerindikator $\rho_{\mcal S} (\eps_{\mcal V})$, den wir durch Lemma \ref{lem:4.14} in seine lokalen Anteile bzgl. der einzelnen Knoten aufteilen können. Daher werden wir diesen im Algorithmus zur Verringerung des Fehlerschätzers verwenden.

Zuletzt bleibt noch aus, dass auch die \idx{Oszillationsterme} in der oberen Schranke von Theorem \ref{theorem:4.22} enthalten sind. Diese sollten sich also in einem Verfeinerungsschritt nicht vergrößern. Diese Forderung können wir mittels Lemma \ref{lem:4.24} erfüllen.

Insgesamt ergibt sich damit folgender adaptiver Algorithmus.


\begin{algorithm}[H]
\caption{Adaptive Verfeinerungsstrategie für ein Hindernisproblem}
Gegeben sei eine Fehlerschranke $\eps>0$, Parameter $\theta_1,\theta_2 \in (0,1)$ und ein initiales Gitter $\mcal T_0$. Wir setzen $\mcal T_n \coloneqq \mcal T_0$.
\begin{algorithmic}[1] 
\State Berechne die Galerkin-Lösung $u_{\mcal S}$ von \eqref{eq:3.12} über der Zerlegung $\mcal T_n$.
\State Berechne die Lösung $\eps_{\mcal V}$ vom lokalen Defektproblem \eqref{eq:4.9} mittels \eqref{eq:4.10} und berechne damit $-\mcal I_{\mcal Q}(\eps_{\mcal V})$.
\State Berechne die lokalen Anteile $\rho_p$ des Fehlerindikators $\rho_{\mcal S}$ mit Lemma \ref{lem:4.14} für alle $p \in \mcal N$ und damit auch $\rho_{\mcal S}$ mit \eqref{eq:4.20}. 
\State Weiter berechne die Mengen $\mcal N^{0+},\mcal N^{++}$ und $\mcal N^{0-}$ um die lokalen Anteile (also die einzelnen Summanden) von $\osc_1(u_{\mcal S},\psi)$ und $\osc_2(u_{\mcal S},\psi,f)$ sowie die globalen \idx{Oszillationsterme} $\osc (u_{\mcal S},\psi,f)$ zu bestimmen.
\If {$-\mcal I_{\mcal Q}(\eps_{\mcal V}) < \eps$}
\State \textbf{break} 
\EndIf 
\State Finde die kleinste Menge an Punkten $\hat{\mcal N}\subset \mcal N$, so dass gilt
\[
	\sum_{p \in \hat{\mcal N}} \rho_p (\eps_{\mcal V}) \ge \theta_1\;\! \rho_{\mcal S}(\eps_{\mcal V}) \,.
\]
\State Erweitere $\hat{\mcal N}$ mit der Menge $\bar{\mcal N}$ zu einer kleinsten Menge an Punkten $\widetilde{\mcal N} \subset \hat{\mcal N}$, so dass gilt
\[
	\osc (u_{\mcal S},\psi,f,\bar{\mcal N}) \ge \theta_2 \osc (u_{\mcal S},\psi,f) \, .
\]
\State Bestimme aus $\widetilde{\mcal N}$ die angrenzenden Dreiecke $\widetilde{\mcal T_n} \subset \mcal T_n$. 
\State Erhalte die neue Triangulierung $\mcal T_{n+1}$ durch die Verfeinerung des Gitters $\mcal T_n$ über die zu verfeinernden Dreiecke $\widetilde{\mcal T_n}$.
\State Setze $n \la n+1$ und Springe zu Schritt 1.
\end{algorithmic}
\end{algorithm}




\section{Erfüllung einer Saturationseigenschaft}
\label{kap:4.3}

In Kapitel \ref{kap:2.4}, in dem wir adaptive Verfeinerungsstrategien für Variationsgleichungen beschrieben haben, musste für den hierarchischen Fehlerschätzer eine \idx{Saturationseigenschaft} erfüllt werden. Dies ist hier nicht benötigt worden, dennoch wird eine solche äquivalente Eigenschaft erfüllt. Wir wollen daher in diesem Kapitel zeigen, dass das für die quadratische Finite-Element-Approximation $u_{\mcal Q}$ mit
\begin{align}\label{eq:4.79}
	u_{\mcal Q} \in K_{\mcal Q} : \quad a(u_{\mcal Q}, v-u_{\mcal Q}) \ge (f,v-u_{\mcal Q}) \quad \forall \, v \in K_{\mcal Q} \, ,
\end{align}
wobei $K_{\mcal Q} = \{v \in \mcal Q \mid v(p)\ge \psi(p) \, \forall \, p \in \mcal N_{\mcal Q} \cap \Omega\}$ ist, die \idx{Saturationseigenschaft}
\begin{align}\label{eq:4.80}
	J(u_{\mcal Q})-J(u) \le \alpha (J(u_{\mcal S})-J(u))
\end{align}
mit $\alpha \in (0,1)$ erfüllt, wenn die \idx{Oszillationsterme} $\osc (u_{\mcal S},\psi,f)$ relativ klein sind. Hierfür werden wir zunächst die Äquivalenz zu einer Ungleichung abhängig von $-\mcal I(e_{\mcal Q})$ zeigen, um dann aufgrund der Äquivalenz von $-\mcal I(e_{\mcal Q})$ zum hierarchischen Fehlerschätzer das gewünschte Resultat zu erhalten.


\begin{lemma}\label{lem:4.26}
Es sei $\alpha \in (0,1)$. Dann gilt die Saturationseigenschaft \eqref{eq:4.80} genau dann, wenn gilt:
\begin{align}\label{eq:4.81}
	J(u_{\mcal S}) - J(u) \le \frac{-\mcal I (e_{\mcal Q})}{1-\alpha} \, .
\end{align}
\end{lemma}

\begin{proof}
Es sei $e_{\mcal Q}$ Lösung von Problem \eqref{eq:4.5} bzw. $u_{\mcal Q}$ Lösung von \eqref{eq:4.79}, damit gilt $u_{\mcal Q} = u_{\mcal S} + e_{\mcal Q}$. Es gilt
\begin{align*}
	& -\mcal I(e_{\mcal Q}) + (J(u_{\mcal Q})-J(u))  \\
	 = & \rho_{\mcal S}(e_{\mcal Q})-\frac 12 a(e_{\mcal Q},e_{\mcal Q}) + \frac 12 a(u_{\mcal Q},u_{\mcal Q})-(f,u_{\mcal Q})-J(u) \\
	 = & (f,e_{\mcal Q})-a(u_{\mcal S},e_{\mcal Q})+a(u_{\mcal S},u_{\mcal Q})-\frac 12 a(u_{\mcal S},u_{\mcal S})-(f,u_{\mcal Q})- J(u) \\
	 = & \underbrace{\frac 1 2 a(u_{\mcal S},u_{\mcal S}) - (f,u_{\mcal S})}_{=J(u_{\mcal S})} - J(u) = J(u_{\mcal S})-J(u) \, .
\end{align*}
Damit folgt, wenn \eqref{eq:4.80} gilt,
\begin{align*}
	J(u_{\mcal S})-J(u) &= -\mcal I (e_{\mcal Q}) + (J(u_{\mcal Q})-J(u)) \\
	& \le -\mcal I(e_{\mcal Q}) + \alpha (J(u_{\mcal S})-J(u))
\end{align*}
und mit Umformung nach $J(u_{\mcal S})-J(u)$ folgt \eqref{eq:4.81}. Analog folgt, wenn \eqref{eq:4.81} gilt:
\begin{align*}
	(1-\alpha)(J(u_{\mcal S}) - J(u)) \le -\mcal I (e_{\mcal Q}) = J(u_{\mcal S})-J(u_{\mcal Q}) 
\end{align*}
und damit folgt nach leichter Umformung \eqref{eq:4.80}.
\end{proof}


\begin{lemma}\label{lem:4.27}
Es gilt
\begin{align}\label{eq:4.82}
	\mcal I(e_{\mcal Q}) \lesssim \mcal I_{\mcal Q} (\eps_{\mcal Q}) \le \mcal I_{\mcal Q} (\eps_{\mcal V}) \le 0 \, .
\end{align}
\end{lemma}

\begin{proof}
Es bezeichne $\eps_{\mcal Q}$ die Lösung des Minimierungsproplems: Finde $\eps_{\mcal Q}\in \mcal A_{\mcal Q}$, so dass
\begin{align}\label{eq:my4.83}
	\mcal I_{\mcal Q} (\eps_{\mcal Q}) \le \mcal I_{\mcal Q} (v) \quad \forall \, v \in \mcal A_{\mcal Q} \, .
\end{align}
Weiter sei $\eps_{\mcal V}\in \mcal A_{\mcal V}$ die Lösung von \eqref{eq:4.8}. Da $0 \in \mcal A_{\mcal V} \subset \mcal A_{\mcal Q}$ liegt, folgt durch Einsetzen von $\eps_{\mcal V}$ in die obige Gleichung bzw. $v = 0$ in \eqref{eq:4.8} die Behauptung
\[
	\mcal I_{\mcal Q}(\eps_{\mcal Q}) \le \mcal I_{\mcal Q} (\eps_{\mcal V}) \le 0 \, .
\]
Analog zu Lemma \ref{lem:4.12} bzw. Korollar \ref{kor:4.13} gilt auch für $\eps_{\mcal Q}$ die Ungleichung $-\mcal I_{\mcal Q} (\eps_{\mcal Q}) \le \rho_{\mcal S} (\eps_{\mcal Q})$. Gilt nun $\rho_{\mcal S} (\eps_{\mcal Q}) \lesssim \rho_{\mcal S}(e_{\mcal Q})$, so folgt mit \eqref{eq:4.16}
\[
	\mcal I(e_{\mcal Q}) \le -\frac 12 \rho_{\mcal S} (e_{\mcal Q}) \lesssim -\rho_{\mcal S} (\eps_{\mcal Q}) \le \mcal I_{\mcal Q}(\eps_{\mcal Q}) \, .
\]
Es bleibt also $\rho_{\mcal S} (\eps_{\mcal Q}) \lesssim \rho_{\mcal S}(e_{\mcal Q})$ zu zeigen. Setzen wir $v = \eps_{\mcal Q}\in \mcal A_{\mcal Q}$ in Problem \eqref{eq:4.5} ein und verwenden die Cauchy-Schwarz-Ungleichung, sowie die für $\eps_{\mcal Q}$ zu \eqref{eq:4.15} und \eqref{eq:4.16} analogen Aussagen, dann ergibt sich
\begin{align}\label{eq:my4.84}
\begin{aligned}
	\rho_{\mcal S} (\eps_{\mcal Q}-e_{\mcal Q}) &\le a(e_{\mcal Q},\eps_{\mcal Q}-e_{\mcal Q}) \stackrel{\scriptsize \text{C.S.}}\le \norm{e_{\mcal Q}} \, \norm{\eps_{\mcal Q}-e_{\mcal Q}} \\
	& \le \rho_{\mcal S}(e_{\mcal Q})^{\frac 12} \norm{\eps_{\mcal Q}-e_{\mcal Q}} \, .
\end{aligned}
\end{align}
Da $e_{\mcal Q},\eps_{\mcal Q}\in \mcal A_{\mcal Q}$ Lösungen von \eqref{eq:4.5} bzw. \eqref{eq:my4.83} sind, folgt aus den dazugehörigen Variationsungleichungen
\begin{align}\label{eq:my4.85}
	-a(e_{\mcal Q}, \eps_{\mcal Q}-e_{\mcal Q}) \le \rho_{\mcal S} (e_{\mcal Q}-\eps_{\mcal Q}) \le a_{\mcal Q} (\eps_{\mcal Q},e_{\mcal Q}-\eps_{\mcal Q}) \, .
\end{align}
Dann folgt wegen der Äquivalenz von $\norm\cdot_{\mcal Q}$ und $\norm{\cdot}$ (vgl. Satz \ref{satz:4.8}), der Cauchy-Schwarz-Ungleichung und \eqref{eq:my4.85} die obere Schranke
\begin{align*}
	\norm{\eps_{\mcal Q}-e_{\mcal Q}}^2 & = a(\eps_{\mcal Q}-e_{\mcal Q},\eps_{\mcal Q}-e_{\mcal Q}) \\
	& = a(\eps_{\mcal Q},\eps_{\mcal Q}-e_{\mcal Q})-a(e_{\mcal Q},\eps_{\mcal Q}-e_{\mcal Q})\\
	&\!\!\!\!\!\; \stackrel{\scriptsize \eqref{eq:my4.85}}\le a(\eps_{\mcal Q},\eps_{\mcal Q}-e_{\mcal Q})+a_{\mcal Q}(\eps_{\mcal Q},e_{\mcal Q}-\eps_{\mcal Q}) \\
	&\!\!\!\;\!\!\!\;\;\!\!\!\:\: \stackrel{\scriptsize \text{C.S.}}\le \norm{\eps_{\mcal Q}} \, \norm{\eps_{\mcal Q}-e_{\mcal Q}} + \norm{\eps_{\mcal Q}}_{\mcal Q} \norm{\eps_{\mcal Q}-e_{\mcal Q}}_{\mcal Q} \\
	&\!\!\!\!\! \stackrel{\scriptsize \text{Satz \ref{satz:4.8}}}\lesssim \norm{\eps_{\mcal Q}}_{\mcal Q} \norm{\eps_{\mcal Q}-e_{\mcal Q}} \, .
\end{align*}
Mit Division durch $\norm{\eps_{\mcal Q}-e_{\mcal Q}}$ erhalten wir dann
\[
	\norm{\eps_{\mcal Q}-e_{\mcal Q}} \lesssim \norm{\eps_{\mcal Q}}_{\mcal Q} \le \rho_{\mcal S}(\eps_{\mcal Q})^{\frac 12} \, ,
\]
wobei wir im letzten Schritt wieder für $\eps_{\mcal Q}$ die zu \eqref{eq:4.15} äquivalente Aussage verwendet haben. Setzen wir dies in \eqref{eq:my4.84} ein, so erhalten wir
\begin{align*}
\rho_S(\eps_{\mcal Q}-e_{\mcal Q}) \le c \,  \rho_{\mcal S} (e_{\mcal Q})^{\frac 12} \rho_{\mcal S}(\eps_{\mcal Q})^{\frac 12} \stackrel{\scriptsize\text{Young}}\le \frac{c^2}2 \rho_{\mcal S}(e_{\mcal Q}) + \frac 12 \rho_{\mcal S}(\eps_{\mcal Q}) 
\end{align*}
mit einer Konstanten $C>0$, die nur von der Quasi-Uniformität von $\mcal T_h$ abhängt. Nach Anwendung der Linearität von $\rho_{\mcal S}$ auf der linken Seite und Umformung nach $\rho_{\mcal S}(\eps_{\mcal Q})$ folgt die Behauptung durch
\[
	\rho_{\mcal S}(\eps_{\mcal Q}) \le \(2+c^2\)\rho_{\mcal S}(e_{\mcal Q}) \lesssim \rho_{\mcal S}(e_{\mcal Q}) \, . \qedhere
\]
\end{proof}

 
\begin{theorem}
Es gibt Konstanten $c >0$ und $\alpha\in (0,1)$, die nur von der Quasi-Uniformität von $\mcal T_h$ abhängt, so dass kleine Oszillation im Sinne von
\begin{align}\label{eq:4.83}
	\osc (u_{\mcal S},\psi,f)^2 \le c\, (J(u_{\mcal S})-J(u))
\end{align}
die Saturationseigenschaft \eqref{eq:4.80}
\[
	J(u_{\mcal Q})-J(u) \le \alpha (J(u_{\mcal S})-J(u))
\]
impliziert.
\end{theorem}

\begin{proof}
Mit Theorem \ref{theorem:4.22} und Lemma \ref{lem:4.27} folgt, dass es zwei Konstanten $c_1, c_2$ gibt, die nur von der Quasi-Uniformität von $\mcal T_h$ abhängen, so dass
\begin{align*}
	J(u_{\mcal S}) - J(u) &\le -c_1 \, \mcal I_{\mcal Q}(\eps_{\mcal V}) + c_2 \osc (u_{\mcal S},\psi,f)^2 \\
	&\!\;\! \!\!\!\stackrel{\scriptsize \eqref{eq:4.83}}\lesssim - c_1 \, \mcal I(e_{\mcal Q})+ c_2c \, (J(u_{\mcal S})-J(u)) \, .
\end{align*}
Wir formen die letzte Aussage nach dem Fehler im Energiefunktional um, so dass
\begin{align*}
	J(u_{\mcal S})-J(u) \lesssim \frac{-\mcal I(e_{\mcal Q})}{\frac{1-c_2c}{c_1}}
\end{align*}
ist und damit gilt für $1-\alpha = \frac{1-c_2c}{c_1}$, dass
\begin{align*}
	c = \frac{1-c_1(1-\alpha)}{c_2}
\end{align*}
sein muss. Setzen wir nun $c_1 \ge 1$, so gilt für $\alpha \in \(\frac{c_1-1}{c_1},1\)\subset(0,1)$, damit $c> 0$ ist. Damit sind die Voraussetzungen aus Lemma \ref{lem:4.26} erfüllt und somit folgt die Behauptung \eqref{eq:4.80}.
\end{proof}







\section{Übertragung des Fehlerschätzers auf Kontaktprobleme}
\label{kap:4.4}


%---------------------------------------------------


\begin{itemize}
\item
\end{itemize}






\newpage

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "Skript"
%%% End: 
