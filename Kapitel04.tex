\newchapter{Ein hierarchischer Fehlerschätzer für Hindernisprobleme}
\label{kap:4}

\begin{itemize}
\item Vergleich Hindernisprobleme zu Kontaktproblemen $\ra$ warum gerade dieser Fehlerschätzer bei Hindernis- bzw. Kontaktproblemen
\end{itemize}

Dieses Kapitel basiert größtenteils auf \cite{ZouVee}.


\section{Herleitung eines a posteriori hierarchischen Fehlerschätzers}
\label{kap:4.1}

\begin{itemize}
\item der Einfachheit halber gehen wir von folgendem Sachverhalt aus
\begin{vor}
Das Hindernis  wird durch eine stückweise lineare stetige Funktion $\psi$ beschrieben.
\end{vor}

\item nicht nichtstetige oder auch glatte Hindernisse sind analoge Aussagen, aber schwerer, beweisbar
\end{itemize}






\subsection{Diskretisierung}
\label{kap:4.1.1}

\begin{itemize}
\item $\mcal B_h$ sei eine nodale Basis bzgl. einer quasi-uniformen Triangulierung $\mcal T_h$  für $\mcal S_h$ (s. auch Kapitel \ref{kap:2}), $K_h$ wie in Kapitel \ref{kap:3.1.3}
\[
	K_h  = \{v_h \in \mcal S_h \with v_h (p) \ge \psi(p) \, \forall \, p \in \mcal N \cap \Omega\} \, , 
\]
wobei $\mcal N$ wieder die Menge der Knoten von $\mcal T_h$ darstellt.

\item betrachte wieder die diskrete Variationsungleichung \eqref{eq:3.12}: Finde $u_h \in K_h$ mit
\[
	a(u_h,v_h-u_h) \ge (f,v_h-u_h) \quad \forall \, v_h \in K_h\, .
\]

\item oder äquivalent die Minimierung des Funktionals $J(v) = \frac 1 2 a(v,v)-(f,v)$ über $K_h$, d.h.
\begin{align}\label{eq:4.1}
	u_h \in K_h :\quad J(u_h)\le J(v_h) \quad \forall \, v_h \in K_h
\end{align}

\item wegen der Voraussetzung, dass $\psi$ stückweise linear ist, gilt $K_h \subset K$, da die linearen Ansatzfunktionen nicht nur punktuell, sondern auch kontinuierlich die Nebenbedingung erfüllen

\item damit ist \eqref{eq:3.12} eine konforme FEM $\ra$ nichtkonforme wollen wir hier nicht betrachten (s. bel. stetige Hindernisse)

\item wir wollen einen a posteriori Fehlerschätzer für den Fehler bzgl. der Funktionswerte der Funktionale $J(u),J(u_h)$ herleiten. Hierbei gilt $J(u_h) - J(u) \ge 0$, denn aus den beiden Minimierungsproblemen über $K$ und $K_h$ folgt
\[
	J(u) \le J(v) \, \forall \, v \in K \, , \quad J(u_h) \le J(v_h) \, \forall \, v_h \in K_h \, .
\]
Da $K_h \subset K$ gilt, folgt auch $J(u)\le J(v_h)$ für alle $v_h \in K_h$. Setze $v_h = u_h$, so gilt
\[
	J(u) \le J(u_h) \Llra J(u_h)-J(u) \ge 0
\]
\item 
\begin{bem}
Gilt $\psi = -\infty$, d.h. ist kein Hindernis vorhanden, so folgt
\begin{align*}
	J(u_h)-J(u)  =& \frac 1 2 a(u_h,u_h)-(f,u_h) - \(\frac 1 2 a(u,u)-(f,u)\) \\
	 =& \frac 1 2 a(u_h,u_h)-(f,u_h) - \frac 1 2 a(u,u)+(f,u) \\
	 & +\overbrace{(a(u,u-u_h)-\underbrace{(f,u-u_h)}_{=(f,u)-(f,u_h)})}^{=0} \\
	 = & \frac 1 2a(u_h,u_h) - \frac 1 2 a(u,u) + a(u,u-u_h) \\
	 = & \frac 1 2 a(u_h,u_h) - \frac 1 2a(u,u)+a(u,u) - a(u,u_h) \\
	 = & \frac1 2 (a(u_h,u_h)+ a(u,u) - 2 a(u,u_h)) \\
	 = & \frac 1 2 a(u_h-u,u_h - u) = \frac 1 2 \norm{u_h-u}^2_E \, .
\end{align*}
Ist nun ein $\psi > -\infty$ gegeben, dann addieren wir im zweiten Schritt nicht mehr Null, sondern es gilt für den Term
\[
	a(u,u-u_h)-(f,u-u_h) \le 0
\]
und damit gilt $J(u_h)-J(u) \ge \frac 1 2\norm{u_h-u}_E^2$, d.h. eine obere Schranke des Fehlers im Funktional schätzt auch den Fehler zwischen exakter und approximierter Lösung in der Energienorm ab.
\end{bem}

\item Herleitung eines hierarchischen a posteriori Fehlerschätzers:

\item 
\begin{notation}
Um im Folgenden den hierarchischen Split leichter beschreiben zu können, schreiben wir für die Galerkin-Lösung $u_h$ die Notation $u_{\mcal S}$, um auszudrücken, dass diese im linearen Ansatzraum $\mcal S_h$ liegt. Analog sind die im Weiteren übrigen verwendeten Indizes zu verstehen.
\end{notation}

\item wir führen Fehlerfunktion $e= u-u_{\mcal S}$ ein

\item weiter sei $\mcal I(v) = \frac 12 a(v,v)-\rho_{\mcal S}(v)$ mit $\rho_{\mcal S} (v) = (f,v)-a(u_{\mcal S},v), v \in H^1_0(\Omega)$.

\item
\begin{bem}
\begin{enumerate}[(a)]
\item Die Linearform $\rho_{\mcal S}$ stellt das Residuum der Variationsgleichung (d.h. ohne Hindernis) dar.
\item Nach dem Darstellungssatz von Riesz existiert ein $v^* \in H^1_0(\Omega)$, so dass
\[
	(v^*,v)_1 = \rho_{\mcal S} (v) \quad\forall \, v \in H^1_0(\Omega)
\]
ist. Wir können also $v^*$ als Lagrange-Multiplikator bzgl. der Nebenbedingung $v \ge \psi$ interpretieren.
\end{enumerate}
\end{bem}

\item neues Minimierungsproblem, jetzt für den Fehler $e$.
\begin{satz}[Lösung des Defektproblems]
Mit den obigen Bezeichnungen löst die Fehlerfunktion $e$ folgendes Defektproblem:
\begin{align}\label{eq:4.2}
	e \in \mcal A:\quad  \mcal I(e) \le \mcal I(v) \quad \forall \, v \in \mcal A \, ,
\end{align}
wobei $\mcal A \coloneqq \{v \in H^1_0(\Omega) \with v \ge \psi-u_{\mcal S}\} = -u_{\mcal S} + K$.
\end{satz}

\begin{proof}
Es sei $u$ die Lösung von \eqref{eq:3.2} und $u_{\mcal S}$ die Lösung von \eqref{eq:4.1}. Dann gilt
\begin{align*}\tag{$\ast$}
	 u \in K : \quad\qquad\quad \,\, \, \, \,  J(u)& \le J(\tilde v )\, \, \, \, \,  \qquad\qquad \forall \, \tilde v \in K \\
	\Llra u \in K : \quad J(u)-J(u_{\mcal S})& \le J(\tilde v) - J(u_{\mcal S}) \quad \forall \, \tilde v \in K \, .
\end{align*}
Wir rechnen für die linke Seite nach, dass gilt
\begin{align*}
	J(u)-J(u_{\mcal S}) & = \frac 1 2 a(u,u) - (f,u) -\(\frac 1 2 a(u_{\mcal S},u_{\mcal S}) - (f,u_{\mcal S})\) \\
	& = \frac 1 2 a(u,u)  + \frac 1 2 a(u_{\mcal S},u_{\mcal S}) - a(u_{\mcal S},u_{\mcal S}) - (f,u-u_{\mcal S}) \\
	& = \frac 1 2 a(u,u)  + \frac 1 2 a(u_{\mcal S},u_{\mcal S}) - a(u_{\mcal S},u) - ((f,u-u_{\mcal S})- a(u_{\mcal S},u-u_{\mcal S})) \\
	& = \frac 1 2a(u-u_{\mcal S},u-u_{\mcal S})- \rho_{\mcal S} (u-u_{\mcal S}) \\
	& = \frac 1 2 a(e,e)-\rho_{\mcal S} (e) = \mcal I(e) \, .
\end{align*}
Analog gilt für die rechte Seite $J(\tilde v ) - J(u_{\mcal S}) = \mcal I(\tilde v - u_{\mcal S})$. Mit $v \coloneqq \tilde v - u_{\mcal S}$ gilt $v \in \mcal A$ und damit ist ($*$) äquivalent zu: Finde $e \in \mcal A$, so dass
\[
	\mcal I(e) \le \mcal I(v) \quad \forall \, v \in\mcal A \, . \qedhere
\]
\end{proof}

\item
\begin{kor}
Das Problem \eqref{eq:4.2} ist äquivalent zur Variationsungleichung: Finde $e \in \mcal A$ mit
\begin{align}\label{eq:4.3}
	a(e,v-e) \ge \rho_{\mcal S} (v-e) \quad \forall \, v \in \mcal A \, .
\end{align}
\end{kor}

\begin{proof}
Analog zu Lemma \ref{lem:3.1} lässt sich zeigen, dass $\mcal A$ abgeschlossen und konvex ist. Mit Satz \ref{satz:A.10} folgt dann die Behauptung.
\end{proof}

\item da $\psi$ stückweise linear ist, liegt $0 \in \mcal A$, d.h. das "`gewünschte"' Ergebnis für $e$ liegt im betrachteten Raum

\item
\begin{bem*}
Wir werden noch zeigen, dass $\rho_{\mcal S}$ eine Schlüsselgröße für die a posteriori Abschätzung darstellt.
\end{bem*}

\item a posteriori Schätzer in 2 Schritten
\begin{enumerate}[(i)]
\item	diskreditiere \eqref{eq:4.3} bzgl. einer Erweiterung von $\mcal S_h$ (hier quadratische Funktionen), so dass $e$ hinreichend genau approximiert wird.
\item Aufteilung des neuen Raumes, sodass \eqref{eq:4.3} lokal in der Erweiterung exakt gelöst werden kann
\end{enumerate}

\item als Erweiterung von $\mcal S_h$ betrachten wir einen Raum $\mcal Q_h$ mit $\mcal S_h \subset \mcal Q_h$.

\item hier bietet sich an: $\mcal Q_h \coloneqq \{v \in C^0(\Omega) \with v|_T \in \mcal P_2 \text{ für } T\in \mcal T_h, v|_{\partial\Omega} = 0\}$, also der Raum der quadratischen Spline über einer quasi-uniformen Zerlegung $\mcal T_h$.

\item damit definiere $\mcal N_{\mcal Q} \coloneqq \mcal N \cup \{x_E \with E \in \mcal E\}$, wobei $x_E$ den Mittelpunkt der Kante $E$ darstellt und $\mcal E$ somit die Menge aller Kanten ist.

\item damit ergibt sich $\mcal A$ über $\mcal Q$ diskret als
\begin{align}\label{eq:4.4}
	\mcal A_{\mcal Q} \coloneqq \{v \in \mcal Q_h \with v(p) \ge \psi(p)-u_{\mcal S}(p) \, \forall \, p \in \mcal N_{\mcal Q} \cap \Omega\}
\end{align}

\item im Bezug zu \eqref{eq:4.4} ergibt sich dann das diskrete Defektproblem
\begin{align}
	e_{\mcal Q} \in \mcal A_{\mcal Q} : \quad a(e_{\mcal Q}, v-e_{\mcal Q}) \ge \rho_{\mcal S}(v-e_{\mcal Q}) \quad \forall \, v \in \mcal A_{\mcal Q}
\end{align}

\item 
\begin{bem}
Im Allgemeinen gilt hierbei nicht $\mcal A_{\mcal Q} \subset \mcal A$. So kann man sich anschaulich eine quadratische Funktion $v_{\mcal Q} \in \mcal A_{\mcal Q}$ vorstellen, die allerdings zwischen den übereinstimmenden Werten aufgrund ihrer Krümmung das lineare Hindernis aus $\mcal A$ durchdringt.

\begin{figure}[h]
\caption{Beispiel eines Hindernisses mit quadratischer Funktion}
\end{figure}
\end{bem}

\item hierarchische Aufteilung von $\mcal Q_h$ durch $\mcal Q_h = \mcal S_h \oplus \mcal V_h$, wobei $\mcal V_h \coloneqq \{\phi_E \with E \in \mcal E\}$ ist und $\phi_E$ die \textit{\idx{Bubble-Funktion}} mit
\[
	\phi_E (p) = \delta_{x_E,p} = \begin{cases}
								1, & p = x_E \\
								0, & \text{sonst}
							\end{cases}
\]
ist

\item
\begin{bsp}
allgemeine Skizze und die drei bubble Funktionen auf einem Referenzdreieck
\end{bsp}

\item
\begin{satz}
Mit den oben verwendeten Notationen gilt $\mcal Q_h = \mcal S_h \oplus \mcal V_h$.
\end{satz}

\begin{proof}
Wir zeigen, dass $\mcal Q_h = \mcal S_h \oplus \mcal V_h$ auf dem Referenzdreieck gilt und damit gilt es auch für beliebige Dreiecke $T \in \mcal T_h$, da ein allgemeines Dreieck $T$ aus dem Referenzelement $\tilde T$ durch affine Transformation hervorgeht.

Auf dem Referenzelement $\tilde T$ ist $\{\phi_1,\phi_2,\phi_3\}$ eine Basis von $\mcal S_h$ mit
\[
	\phi_1(\xi,\eta) = 1-\xi-\eta \, , \quad \phi_2(\xi,\eta) = \xi \, , \quad \phi_3(\xi,\eta) = \eta
\]
und $\{\phi_4,\phi_5,\phi_6\}$ eine Basis von $\mcal V_h$ mit
\[
	\phi_1(\xi,\eta) = 4\xi (1-\xi-\eta) \, , \quad \phi_2(\xi,\eta) = 4\xi\eta \, , \quad \phi_3(\xi,\eta) = 4\eta(1-\xi-\eta) \, .
\]
Damit ist $\{\phi_1,\ldots,\phi_6\}$ ein Erzeugendensystem von $\mcal Q_h$, da jedes Element
\[
	a_0+a_1\xi+a_2\eta + a_3 \xi^2+ a_4\xi\eta +a_5\eta^2 \in \mcal Q_h
\]
als Linearkombination aus den Funktionen beschrieben werden kann ($\phi_1$ bis $\phi_6$ enthalten alle vorkommenden Summanden eines Polynom 2. Grades). Außerdem ist leicht nachzurechnen, dass die Funktionen $\phi_i,i = 1,\ldots,6,$ linear unabhängig sind und damit gilt
\[
	\mcal Q_h = \operatorname{span} \{\phi_1,\ldots,\phi_6\} \, .
\]
Aus der linearen Unabhängigkeit folgt damit auch $\mcal S_h \cap \mcal V_h = \{0\}$ gilt und damit die Behauptung.
\end{proof}

\item daher kann jedes Element $v_{\mcal Q} \in \mcal Q_h$  als $v_{\mcal Q} = v_{\mcal S} + v_{\mcal V}$ mit $v_{\mcal S} \in \mcal S_h, v_{\mcal V}\in \mcal V_h$ geschrieben werden

\item aus diesem Grund führen wir folgende Bilinearform ein:
\begin{align*}
	a_{\mcal Q} (v,w) \coloneqq a(v_{\mcal S},w_{\mcal S}) + \sum_{E \in \mcal E} u_{\mcal V}(x_E) w_{\mcal V}(x_E) a(\phi_E,\phi_E) \quad \forall \, v,w \in \mcal Q_h \, ,
\end{align*}
welche aufgrund der Eigenschaften der direkten Summe von $\mcal S_h$ und $\mcal V_h$ wohldefiniert ist.

\item dabei ergibt sich $a_{\mcal Q}$ durch Entkopplung von $\mcal S_h$ und $\mcal V_h$ und anschließender "`Diagonalisierung"' auf $\mcal V$

\item sinnvoll $a_{\mcal Q}$ so einzuführen, denn:
\begin{satz}
Die zu $a_{\mcal Q}$ assoziierte Energienorm
\begin{align*}
	\norm v_{\mcal Q}\coloneqq a_{\mcal Q}(v,v)^{\frac 1 2} \, , \quad v \in \mcal Q_h
\end{align*}
ist äquivalent zur Energienorm $\norm\cdot_E$, d.h. es gibt Konstanten $c_1,c_2$ $($die insbesondere nur von der Quasi-Uniformität von $\mcal T_h$ abhängen$)$, so dass
\[
	c_1 \norm v_E \le \norm v_{\mcal Q} \le c_2 \norm v_E \, , \quad \forall \, v \in \mcal Q_h \, .
\]
\end{satz}

\begin{proof}
Die Aussage folgt aus Theorem 4.1 bzw. Bemerkung 4.3 in \cite{HoppeKorn} zusammen mit dem Lemma auf Seite 14 in \cite{Deufl}.
\end{proof}

\item daher führen wir die approximierte Energie
\begin{align}\label{eq:4.6}
	\mcal I_{\mcal Q} (v) \coloneqq \frac 1 2 a_{\mcal Q}(v,v)-\rho_{\mcal S}(v) \, , \quad v \in \mcal Q_h 
\end{align}
ein.

\item das damit verbundene Defektproblem ist allerdings noch durch die Nebenbedingung aus $\mcal A_{\mcal Q}$ mit $\mcal S_h$ gekoppelt und daher noch nicht alleine auf die Raumerweiterung $\mcal V_h$ bezogen.

\item Als Abhilfe ignorieren wir einfach die linearen Beiträge in $\mcal A_{\mcal Q}$ und führen eine echte Teilmenge 
\begin{align}\label{eq:4.7}
	\mcal A_{\mcal V} \coloneqq \{v \in \mcal V \with v(x_E) \ge \psi(x_E)-u_{\mcal S}(x_E) \, \forall \, E \in \mcal E\}
\end{align}
von $\mcal A_{\mcal Q}$ ein.

\item zusammen mit \eqref{eq:4.6} und \eqref{eq:4.7} erhalten wir das lokale diskrete Defektproblem
\begin{align}\label{eq:4.8}
	\eps_{\mcal V} \in \mcal A_{\mcal V} : \quad \mcal I_{\mcal Q}(\eps_{\mcal V}) \le \mcal I_{\mcal Q} (v) \quad \forall \, v \in \mcal A_{\mcal V}
\end{align}
bzw. die dazu äquivalente Variationsungleichung
\begin{align}\label{eq:4.9}
	\eps_{\mcal V} \in \mcal A_{\mcal V} : \quad a_{\mcal Q} (\eps_{\mcal V},v-\eps_{\mcal V})\ge \rho_{\mcal S} (v-\eps_{\mcal V}) \quad \forall \, v \in \mcal A_{\mcal V} \, .
\end{align}

\item
\begin{bem}
\begin{enumerate}[(a)]
\item Da $\psi$ stetig stückweise linear ist und somit $u_{\mcal S} \ge \psi$ gilt, folgt $0 \in \mcal A_{\mcal V}$. Damit ist auch hier die gewünschte Lösung für $\eps_{\mcal V}$ in $\mcal A_{\mcal V}$ enthalten
\item	Auch für $\mcal A_{\mcal V}$ lässt sich mit analogem Vorgehen zu Lemma \ref{lem:3.1} die Konvexität zeigen.
\end{enumerate}
\end{bem}

\item
\begin{lemma}
Das Energiefunktional $\mcal I_{\mcal Q}$ ist konvex.
\end{lemma}

\begin{proof}
Da $a$ eine stetige koerzive Bilinearform, werden aufgrund der Konstruktion von $a_{\mcal Q}$ diese Eigenschaften auch auf $a_{\mcal Q}$ übertragen. Weiterhin ist leicht zu überprüfen, dass $\rho_{\mcal S}$ eine stetige Linearform ist. Dann folgt aus Lemma \ref{lem:2.3} direkt die Behauptung.
\end{proof}

\item Lösung des lokalen Defektproblems
\begin{satz}
Die Lösung von \eqref{eq:4.8} bzw. \eqref{eq:4.9} ist explizit gegeben durch
\begin{align}\label{eq:4.10}
	\eps_{\mcal V} (x_E) = \frac{\max \{-d_E,\rho_E\}}{\norm{\phi_E}} \, 
\end{align}
wobei
\begin{align}\label{eq:4.11}
	d_E = (u_{\mcal S}(x_E) - \psi (x_E))\norm{\phi_E} \ge 0 \, , \quad \rho_E = \frac{\rho_{\mcal S}(\phi_E)}{\norm{\phi_E}} \, .
\end{align}
\end{satz}

\begin{proof}
Zunächst berechnen wir zur besseren Übersicht $\eps_{\mcal V}(x_E)$ konkret, d.h.
\begin{align}\notag
	\eps_{\mcal V} (x_E) & =  \frac{\max \{-d_E,\rho_E\}}{\norm{\phi_E}} \\
	\notag
	& = \frac{\max \left\{(\psi (x_E)-u_{\mcal S}(x_E) )\norm{\phi_E} ,\frac{\rho_{\mcal S}(\phi_E)}{\norm{\phi_E}}\right\}}{\norm{\phi_E}} \\
	\notag
	& = \max \left\{\psi (x_E)-u_{\mcal S}(x_E)  ,\frac{\rho_{\mcal S}(\phi_E)}{\norm{\phi_E}^2}\right\} \\
	\label{eq:4.12}
	& = \max \left\{\psi (x_E)-u_{\mcal S}(x_E)  ,\frac 1{\norm{\phi_E}^2} ((f,\phi_E)-a(u_{\mcal S},\phi_E))	\right\} \, .
\end{align}
Da wir  q
\end{proof}
\end{itemize}





\subsection{Lokaler Anteil des Fehlerschätzers}
\label{kap:4.1.2}



\subsection{Oszillationsterme}
\label{kap:4.1.3}



\subsection{Zuverlässigkeit des Fehlerschätzers}
\label{kap:4.1.4}



\subsection{Effektivität des Fehlerschätzers}
\label{kap:4.1.5}



\section{Ein adaptiver Algorithmus}
\label{kap:4.2}



\section{Erfüllung einer Saturationseigenschaft}
\label{kap:4.3}



\section{Übertragung des Fehlerschätzers auf Kontaktprobleme}
\label{kap:4.4}


\newpage

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "Skript"
%%% End: 
